/*
* @nebula.js/nucleus v0.1.0-alpha.29
* Copyright (c) 2020 QlikTech International AB
* Released under the MIT license.
*/

import e from"@nebula.js/locale";import t from"@nebula.js/theme";import n,{useState as r,useEffect as o,useReducer as a,forwardRef as i,useMemo as c,useImperativeHandle as s,useRef as l,useCallback as u,useContext as p,useLayoutEffect as f}from"react";import m from"react-dom";import{createTheme as d,createGenerateClassName as h,StylesProvider as v,ThemeProvider as E,makeStyles as g,useTheme as S}from"@nebula.js/ui/theme";import{Grid as R,Typography as y,MenuItem as b,ListItemIcon as I,Button as O,IconButton as q,OutlinedInput as L,InputAdornment as w,Popover as N,MenuList as C,Badge as T,List as A,ListItem as x,Box as k,makeStyles as D,CircularProgress as j,Paper as P}from"@material-ui/core";import M from"@nebula.js/ui/icons/remove";import z from"@nebula.js/ui/icons/lock";import F from"@nebula.js/ui/icons/unlock";import{more as U}from"@nebula.js/ui/icons/more";import{FixedSizeList as B}from"react-window";import G from"react-window-infinite-loader";import W,{tick as H}from"@nebula.js/ui/icons/tick";import{selectAll as V}from"@nebula.js/ui/icons/select-all";import{selectAlternative as _}from"@nebula.js/ui/icons/select-alternative";import{selectPossible as X}from"@nebula.js/ui/icons/select-possible";import{selectExcluded as K}from"@nebula.js/ui/icons/select-excluded";import{close as J}from"@nebula.js/ui/icons/close";import $,{clearSelections as Y}from"@nebula.js/ui/icons/clear-selections";import Q from"@nebula.js/ui/icons/SvgIcon";import Z from"@nebula.js/ui/icons/search";import ee from"node-event-emitter";import te from"@nebula.js/ui/icons/down-arrow";import ne from"@nebula.js/ui/icons/selections-back";import re from"@nebula.js/ui/icons/selections-forward";import oe from"@nebula.js/ui/icons/warning-triangle-2";import{generator as ae}from"@nebula.js/supernova";function ie(e){return(ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ce(e,t,n,r,o,a,i){try{var c=e[a](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function se(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){ce(a,r,o,i,c,"next",e)}function c(e){ce(a,r,o,i,c,"throw",e)}i(void 0)}))}}function le(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ue(){return(ue=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function pe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function fe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?pe(Object(n),!0).forEach((function(t){le(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function me(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function de(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,o=!1,a=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,a=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw a}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function he(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var ve={Object_Update_Active:{id:"Object.Update.Active",locale:{"en-US":"Updating data"}},Object_Update_Cancelled:{id:"Object.Update.Cancelled",locale:{"en-US":"Data update was cancelled"}},Supernova_Incomplete:{id:"Supernova.Incomplete",locale:{"en-US":"Incomplete visualization","it-IT":"Visualizzazione incompleta","zh-CN":"不完整的可视化","zh-TW":"視覺化未完成","ko-KR":"완료되지 않은 시각화","de-DE":"Unvollständige Visualisierung","sv-SE":"Ofullständig visualisering","es-ES":"Visualización incompleta","pt-BR":"Visualização incompleta","ja-JP":"未完了のビジュアライゼーション","fr-FR":"Visualisation incomplète","nl-NL":"Onvolledige visualisatie","tr-TR":"Tamamlanmamış görselleştirme","pl-PL":"Niekompletna wizualizacja","ru-RU":"Незавершенная визуализация"}},Cancel:{id:"Common.Cancel",locale:{"en-US":"Cancel","de-DE":"Abbrechen","es-ES":"Cancelar","fr-FR":"Annuler","ja-JP":"キャンセル","nl-NL":"Annuleren","it-IT":"Annulla","ko-KR":"취소","pl-PL":"Anuluj","ru-RU":"Отмена","pt-BR":"Cancelar","sv-SE":"Avbryt","zh-CN":"取消","tr-TR":"İptal","zh-TW":"取消"}},OK:{id:"Common.OK",locale:{"en-US":"OK","de-DE":"OK","es-ES":"Aceptar","fr-FR":"OK","ja-JP":"OK","nl-NL":"OK","it-IT":"OK","ko-KR":"확인","pl-PL":"OK","ru-RU":"ОК","pt-BR":"OK","sv-SE":"OK","zh-CN":"确定","tr-TR":"Tamam","zh-TW":"確定"}},Retry:{id:"Common.Retry",locale:{"en-US":"Retry","it-IT":"Riprova","zh-CN":"重试","zh-TW":"重試","ko-KR":"다시 시도","de-DE":"Wiederholen","sv-SE":"Försök igen","es-ES":"Intentar de nuevo","pt-BR":"Tentar Novamente","ja-JP":"再試行","fr-FR":"Réessayer","nl-NL":"Opnieuw","tr-TR":"Yeniden dene","pl-PL":"Ponów próbę","ru-RU":"Повторить попытку"}},CurrentSelections_All:{id:"CurrentSelections.All",locale:{"en-US":"ALL","it-IT":"TUTTO","zh-CN":"全部","zh-TW":"全部","ko-KR":"모두","de-DE":"ALLES","sv-SE":"ALLA","es-ES":"TODOS","pt-BR":"TODOS","ja-JP":"すべて","fr-FR":"TOUS","nl-NL":"ALLE","tr-TR":"TÜMÜ","pl-PL":"WSZYSTKO","ru-RU":"ВСЕ"}},CurrentSelections_Of:{id:"CurrentSelections.Of",locale:{"en-US":"{0} of {1}","it-IT":"{0} di {1}","zh-CN":"{0}/{1}","zh-TW":"{0} / {1}","ko-KR":"{0} / {1}","de-DE":"{0} von {1}","sv-SE":"{0} av {1}","es-ES":"{0} de {1}","pt-BR":"{0} de {1}","ja-JP":"{0} / {1}","fr-FR":"{0} sur {1}","nl-NL":"{0} van {1}","tr-TR":"{0} / {1}","pl-PL":"{0} z {1}","ru-RU":"{0} из {1}"}},Listbox_Search:{id:"Listbox.Search",locale:{"en-US":"Search in listbox","it-IT":"Cerca nella casella di elenco","zh-CN":"在列表框中搜索","zh-TW":"在清單方塊中搜尋","ko-KR":"목록 상자에서 검색","de-DE":"In Listenfeld suchen","sv-SE":"Sök i listruta","es-ES":"Buscar en cuadro de lista","pt-BR":"Pesquisar na caixa de listagem","ja-JP":"リストボックス内を検索","fr-FR":"Rechercher dans la liste de sélection","nl-NL":"Zoeken in keuzelijst","tr-TR":"Liste kutusunda ara","pl-PL":"Wyszukaj w liście wartości","ru-RU":"Поиск в списке"}},Navigate_Forward:{id:"Navigate.Forward",locale:{"en-US":"Step forward","it-IT":"Vai avanti","zh-CN":"前进","zh-TW":"前進","ko-KR":"다음 단계","de-DE":"Schritt vor","sv-SE":"Gå framåt","es-ES":"Avanzar","pt-BR":"Avançar uma etapa","ja-JP":"1段階進む","fr-FR":"Étape suivante","nl-NL":"Stap vooruit","tr-TR":"Bir adım ileri","pl-PL":"Krok do przodu","ru-RU":"Шаг вперед"}},Navigate_Back:{id:"Navigate.Back",locale:{"en-US":"Step back","it-IT":"Torna indietro","zh-CN":"后退","zh-TW":"倒退","ko-KR":"이전 단계","de-DE":"Schritt zurück","sv-SE":"Gå bakåt","es-ES":"Retroceder","pt-BR":"Voltar uma etapa","ja-JP":"1 段階戻る","fr-FR":"Retour en arrière","nl-NL":"Stap terug","tr-TR":"Bir adım geri","pl-PL":"Krok do tyłu","ru-RU":"Шаг назад"}},Selection_ClearAll:{id:"Selection.ClearAll",locale:{"en-US":"Clear all selections","it-IT":"Cancella tutte le selezioni","zh-CN":"清除所有选择项","zh-TW":"清除所有選項","ko-KR":"모든 선택 해제","de-DE":"Auswahl aufheben (alle Felder)","sv-SE":"Rensa alla urval","es-ES":"Borrar todas las selecciones","pt-BR":"Limpar todas as seleções","ja-JP":"選択をすべてクリアする","fr-FR":"Effacer toutes les sélections","nl-NL":"Alle selecties wissen","tr-TR":"Tüm seçimleri temizle","pl-PL":"Wyczyść wszystkie selekcje","ru-RU":"Очистить от всех выборок"}},Selection_ClearAllStates:{id:"Selection.ClearAllStates",locale:{"en-US":"Clear all states","it-IT":"Cancella tutti gli stati","zh-CN":"清除所有状态","zh-TW":"清除所有狀態","ko-KR":"모든 상태 지우기","de-DE":"Alle Status löschen","sv-SE":"Rensa alla tillstånd","es-ES":"Borrar todos los estados","pt-BR":"Limpar todos os estados","ja-JP":"全ステートをクリア","fr-FR":"Effacer tous les états","nl-NL":"Alle states wissen","tr-TR":"Tüm durumları temizle","pl-PL":"Wyczyść wszystkie stany","ru-RU":"Очистить все состояния"}},Selection_Confirm:{id:"Selection.Confirm",locale:{"en-US":"Confirm selection","it-IT":"Conferma selezione","zh-CN":"确认选择","zh-TW":"確認選取","ko-KR":"선택 확인","de-DE":"Auswahl bestätigen","sv-SE":"Bekräfta urval","es-ES":"Confirmar selección","pt-BR":"Confirmar seleção","ja-JP":"選択の確認","fr-FR":"Confirmer la sélection","nl-NL":"Selectie bevestigen","tr-TR":"Seçimi onayla","pl-PL":"Potwierdź selekcję","ru-RU":"Подтвердить выборку"}},Selection_Cancel:{id:"Selection.Cancel",locale:{"en-US":"Cancel selection","it-IT":"Annulla selezione","zh-CN":"取消选择","zh-TW":"取消選取","ko-KR":"선택 취소","de-DE":"Auswahl abbrechen","sv-SE":"Avbryt urval","es-ES":"Cancelar selección","pt-BR":"Cancelar seleção","ja-JP":"選択のキャンセル","fr-FR":"Annuler la sélection","nl-NL":"Selectie annuleren","tr-TR":"Seçimi iptal et","pl-PL":"Anuluj selekcję","ru-RU":"Отменить выборку"}},Selection_Clear:{id:"Selection.Clear",locale:{"en-US":"Clear selection","it-IT":"Cancella selezione","zh-CN":"清除选择","zh-TW":"清除選項","ko-KR":"선택 해제","de-DE":"Auswahl löschen","sv-SE":"Rensa urval","es-ES":"Borrar selección","pt-BR":"Limpar seleção","ja-JP":"選択をクリア","fr-FR":"Effacer la sélection","nl-NL":"Selectie wissen","tr-TR":"Seçimi temizle","pl-PL":"Wyczyść selekcję","ru-RU":"Очистить выбор"}},Selection_SelectAll:{id:"Selection.SelectAll",locale:{"en-US":"Select all","it-IT":"Seleziona tutto","zh-CN":"全选","zh-TW":"全選","ko-KR":"모두 선택","de-DE":"Alle Werte auswählen","sv-SE":"Markera alla","es-ES":"Seleccionar todo","pt-BR":"Selecionar todos","ja-JP":"すべて選択","fr-FR":"Sélectionner tout","nl-NL":"Alles selecteren","tr-TR":"Tümünü seç","pl-PL":"Wybierz wszystko","ru-RU":"Выбрать все"}},Selection_SelectAlternative:{id:"Selection.SelectAlternative",locale:{"en-US":"Select alternative","it-IT":"Seleziona alternativi","zh-CN":"选择替代项","zh-TW":"選取替代選項","ko-KR":"대안 선택","de-DE":"Alternative Werte auswählen","sv-SE":"Välj alternativ","es-ES":"Seleccionar alternativos","pt-BR":"Selecionar alternativa","ja-JP":"代替値を選択","fr-FR":"Sélectionner des valeurs alternatives","nl-NL":"Alternatief selecteren","tr-TR":"Alternatifi seç","pl-PL":"Wybierz alternatywę","ru-RU":"Выбрать альтернативные"}},Selection_SelectExcluded:{id:"Selection.SelectExcluded",locale:{"en-US":"Select excluded","it-IT":"Seleziona esclusi","zh-CN":"选择排除项","zh-TW":"選取排除值","ko-KR":"제외 항목 선택","de-DE":"Ausgeschlossene Werte auswählen","sv-SE":"Välj uteslutna","es-ES":"Seleccionar excluidos","pt-BR":"Selecionar excluído","ja-JP":"除外値を選択","fr-FR":"Sélectionner les valeurs exclues","nl-NL":"Uitgesloten selecteren","tr-TR":"Hariç tutulanı seç","pl-PL":"Wybierz wykluczone","ru-RU":"Выбрать исключенные"}},Selection_SelectPossible:{id:"Selection.SelectPossible",locale:{"en-US":"Select possible","it-IT":"Seleziona possibili","zh-CN":"选择可能值","zh-TW":"選取可能值","ko-KR":"사용 가능 항목 선택","de-DE":"Wählbare Werte auswählen","sv-SE":"Välj möjliga","es-ES":"Seleccionar posibles","pt-BR":"Selecionar possível","ja-JP":"絞込値を選択","fr-FR":"Sélectionner les valeurs possibles","nl-NL":"Mogelijke selecteren","tr-TR":"Olasıyı seç","pl-PL":"Wybierz możliwe","ru-RU":"Выбрать возможные"}},Selection_Menu:{id:"Selection.Menu",locale:{"en-US":"Selection menu","it-IT":"Menu Selezione","zh-CN":"选择菜单","zh-TW":"選項功能表","ko-KR":"선택 메뉴","de-DE":"Auswahlmenü","sv-SE":"Urvalsmeny","es-ES":"Menú de selección","pt-BR":"Menu de seleção","ja-JP":"選択メニュー","fr-FR":"Menu Sélection","nl-NL":"Selectiemenu","tr-TR":"Seçim menüsü","pl-PL":"Menu selekcji","ru-RU":'Меню "Выборка"'}}};function Ee(t){var n=e({initial:t});return Object.keys(ve).forEach((function(e){n.translator.add(ve[e])})),{translator:n.translator}}var ge=function(e,t){return new Promise((function(n){return setTimeout((function(){return n(t)}),e)}))};function Se(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.themes,r=void 0===n?[]:n,o=e.logger,a=e.root,i=t(),c=function(){var e=se(regeneratorRuntime.mark((function e(t){var n,c,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.filter((function(e){return e.key===t}))[0],c="dark"===t?"dark":"light",!n||!n.load){e.next=15;break}return e.prev=3,e.next=6,Promise.race([n.load(),ge(5e3,{__timedOut:!0})]);case 6:(s=e.sent).__timedOut?o.warn("Timeout when loading theme '".concat(t,"'")):(c="dark"===s.type?"dark":"light",i.internalAPI.setTheme(s,t),a.setMuiThemeName(c)),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(3),o.error(e.t0);case 13:e.next=17;break;case 15:i.internalAPI.setTheme({type:c},t),a.setMuiThemeName(c);case 17:case"end":return e.stop()}}),e,null,[[3,10]])})));return function(t){return e.apply(this,arguments)}}();return{setTheme:c,externalAPI:i.externalAPI}}var Re=n.createContext({language:null,theme:null,translator:null,constraints:{}}),ye=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},n=e,a=[],i={get:function(e){return n[e]},set:function(e,r){if(void 0===e||"object"===ie(e))throw new Error("Invalid key: ".concat(JSON.stringify(e)));return n[e]=r,t({type:"SET",value:r}),r},clear:function(){return Object.keys(n).forEach((function(e){n[e]=null}))},dispatch:function(e){a.forEach((function(t){return t(e?{}:n)}))}},c=function(){var e=de(r(n),2)[1];return o((function(){return a.push(e),function(){var t=a.indexOf(e);a.splice(t,1)}}),[e]),[i]};return[c,i]},be=de(ye({}),2),Ie=be[0],Oe=be[1],qe=de(ye({}),2),Le=qe[0],we=qe[1],Ne=de(ye({}),2),Ce=Ne[0],Te=Ne[1],Ae=de(ye({}),2),xe=(Ae[0],Ae[1]),ke=de(ye({}),2),De=ke[0],je=ke[1],Pe=de(ye({}),2)[1],Me=function(e){var t=e.type,n=e.value;if(!Pe.get(n.id)){Pe.set(n.id,{});var r=function(){we.set(n.id,void 0),je.set(n.id,{}),je.dispatch(!0)};switch(t){case"SET":n.on("changed",r),n.once("closed",(function(){n.removeListener("changed",r),function(e){Oe.set(e.id,void 0),we.set(e.id,void 0),Te.set(e.id,void 0),xe.set(e.id,void 0),je.set(e.id,void 0),Pe.set(e.id,void 0)}(n)}))}}},ze=de(ye({},Me),2),Fe=ze[0],Ue=ze[1],Be=function(e){Me({type:"SET",value:e})},Ge=function(e,t){var n,r=t.rpcResultStore,o=t.key,a=t.method;switch(t.type){case"INVALID":n=fe({},e,{valid:!1,invalid:!0,validating:!0,canCancel:!0,canRetry:!1,rpcRetry:!1});break;case"VALID":n={result:fe({},t.result),invalid:!1,valid:!0,validating:!1,canCancel:!1,canRetry:!1,rpcRetry:!1};break;case"CANCELLED":n={invalid:!0,valid:!1,validating:!1,canCancel:!1,canRetry:!0,rpcRetry:!1};break;default:throw new Error("Undefined action")}var i=r.get(o);return i||(i={}),i[a]=n,r.set(o,i),n};function We(e,t){var n,r=e?"".concat(e.id):null,i=de(Ie(),1)[0],c=de(a(Ge,r?i.get(r):null),2),s=c[0],l=c[1],u=de(De(),1)[0],p=de(Le(),1)[0];r&&((n=p.get(r))||(n={},p.set(r,n)));var f,m=function(){var o=se(regeneratorRuntime.mark((function o(a){var c,s,u;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return(!(c=n[t])||c&&c.rpcRetry)&&(s=e[t](),c={rpc:s,rpcRetry:!1},n[t]=c,l({type:"INVALID",method:t,key:r,model:e,rpcResultStore:i,canCancel:!0})),o.prev=2,o.next=5,c.rpc;case 5:u=o.sent,l({type:"VALID",result:u,key:r,method:t,model:e,rpcResultStore:i}),o.next=12;break;case 9:o.prev=9,o.t0=o.catch(2),15!==o.t0.code||a||(c.rpcRetry||(c.rpcRetry=!0),m(!0));case 12:case"end":return o.stop()}}),o,null,[[2,9]])})));return function(e){return o.apply(this,arguments)}}(),d={cancel:(f=se(regeneratorRuntime.mark((function o(){var a;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return a=e.session.getObjectApi({handle:-1}),o.next=3,a.cancelRequest(n[t].rpc.requestId);case 3:l({type:"CANCELLED",key:r,method:t,model:e,rpcResultStore:i});case 4:case"end":return o.stop()}}),o)}))),function(){return f.apply(this,arguments)}),retry:function(){n[t].rpcRetry=!0,m()}};return o((function(){e&&m()}),[e,u.get(e&&e.id),r,t]),[s&&s.result,{validating:s&&s.validating,canCancel:s&&s.canCancel,canRetry:s&&s.canRetry},d]}function He(e){return We(e,"getLayout")}function Ve(e){return We(e,"getAppLayout")}function _e(e,t){var n,a=t?"".concat(t.id,"/").concat(JSON.stringify(e)):null,i=Fe(),c=de(i,1),s=c[0],l=Ce(),u=de(l,1),p=u[0],f=r(),m=de(f,2),d=m[0],h=m[1];a&&(n=p.get(a));for(var v=arguments.length,E=new Array(v>2?v-2:0),g=2;g<v;g++)E[g-2]=arguments[g];return o((function(){t&&function(){var r=se(regeneratorRuntime.mark((function r(){var o,i;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n||(o=t.createSessionObject(e),n=o,p.set(a,n)),r.next=3,n;case 3:i=r.sent,s.set(a,i),h(i);case 6:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}()()}),[t].concat(E)),[d]}var Xe={qInfo:{qType:"current-selections"},qSelectionObjectDef:{qStateName:"$"},alternateStates:[]};function Ke(e){return _e(Xe,e)}function Je(e){var t=de(Ke(e),1)[0],n=de(He(t),1)[0],a=de(Ve(e),1)[0],i=de(r(null),2),c=i[0],s=i[1];return o((function(){a&&t&&n&&function(e,t,n){var r=he(n.qStateNames||[]).map((function(e){return{stateName:e,qSelectionObjectDef:{qStateName:e}}}));(t&&t.alternateStates?t.alternateStates.map((function(e){return e.stateName})):[]).join("::")!==(n.qStateNames||[]).map((function(e){return e})).join("::")&&e.applyPatches([{qOp:"replace",qPath:"/alternateStates",qValue:JSON.stringify(r)}],!0)}(t,n,a)}),[a,t,n]),o((function(){if(n){var e=!1,t=!1,r=!1;[n].concat(he(n.alternateStates||[])).forEach((function(n){e=e||n.qSelectionObject&&n.qSelectionObject.qBackCount>0,t=t||n.qSelectionObject&&n.qSelectionObject.qForwardCount>0,r=r||(n.qSelectionObject&&n.qSelectionObject.qSelections||[]).filter((function(e){return!0!==e.qLocked})).length>0})),s({canGoBack:e,canGoForward:t,canClear:r})}}),[n]),[c,t,n]}var $e=de(ye({}),2),Ye=$e[0],Qe=($e[1],de(ye({}),2)),Ze=Qe[0],et=Qe[1],tt=de(ye({}),2),nt=tt[0],rt=tt[1];function ot(e){if(!e.session)return[];var t=de(Je(e),3),n=t[0],r=t[1],a=t[2],i=de(Ye(),1)[0],c=e?e.id:null,s=i.get(c);return o((function(){e&&r&&a&&n&&!s&&(s=function(e){var t=e.app,n=e.currentSelectionsLayout,r=e.navState,o="".concat(t.id),a={model:t,switchModal:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(e===rt.get(o))return Promise.resolve();var r=rt.get(o);if(r){r.endSelections(n);var i=et.get(r.id);i.emit("deactivated")}return e&&void 0!==e?(rt.set(o,e),e.beginSelections(Array.isArray(t)?t:[t]).catch((function(n){if(6003===n.code)return a.abortModal().then((function(){return e.beginSelections(Array.isArray(t)?t:[t])}));throw n})),Promise.resolve()):(rt.set(o,void 0),Promise.resolve())},isInModal:function(){return!!rt.get(o)},isModal:function(e){return e?rt.get(o)===e:!!rt.get(o)},abortModal:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return rt.get(o)?(rt.set(o,void 0),t.abortModal(e)):Promise.resolve()},canGoForward:function(){return r.canGoForward},canGoBack:function(){return r.canGoBack},canClear:function(){return r.canClear},layout:function(){return n},forward:function(){return a.switchModal().then((function(){return t.forward()}))},back:function(){return a.switchModal().then((function(){return t.back()}))},clear:function(){return a.switchModal().then((function(){return t.clearAll()}))},clearField:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"$";return a.switchModal().then((function(){return t.getField(e,n).then((function(e){return e.clear()}))}))}};return a}({app:e,currentSelectionsLayout:a,navState:n}),i.set(c,s))}),[e,r,a,n]),[s,n]}var at="0.1.0-alpha.29".replace(/[.-]/g,"_"),it=0,ct=i((function(e,t){var o=e.initialContext,a=de(ot(e.app),1)[0],i=de(r(o),2),l=i[0],u=i[1],p=de(r(),2),f=p[0],m=p[1],g=c((function(){return{theme:d(f),generator:h({productionPrefix:"".concat(at,"-"),disableGlobal:!0,seed:"nebulajs-".concat(it++)})}}),[f]),S=g.theme,R=g.generator,y=de(r([]),2),b=y[0],I=y[1];return s(t,(function(){return{addComponent:function(e){I([].concat(he(b),[e]))},removeComponent:function(e){var t=b.indexOf(e);-1!==t&&(b.splice(t,1),I(he(b)))},setMuiThemeName:m,setContext:u,getAppSelections:function(){return a}}})),n.createElement(v,{generateClassName:R},n.createElement(E,{theme:S},n.createElement(Re.Provider,{value:l},n.createElement(n.Fragment,null,b))))}));function st(e){var t,r,o=e.app,a=e.context,i=new Promise((function(e){t=e})),c=n.createRef(),s=document.createElement("div");return s.style.display="none",s.setAttribute("data-nebulajs-version","0.1.0-alpha.29"),s.setAttribute("data-app-id",o.id),document.body.appendChild(s),m.render(n.createElement(ct,{ref:c,app:o,initialContext:a}),s,t),[{add:function(e){se(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i;case 2:c.current.addComponent(e);case 3:case"end":return t.stop()}}),t)})))()},remove:function(e){se(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i;case 2:c.current.removeComponent(e);case 3:case"end":return t.stop()}}),t)})))()},setMuiThemeName:function(e){se(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i;case 2:c.current.setMuiThemeName(e);case 3:case"end":return t.stop()}}),t)})))()},context:function(e){se(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i;case 2:c.current.setContext(e);case 3:case"end":return t.stop()}}),t)})))()},getAppSelections:(r=se(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i;case 2:return e.abrupt("return",c.current.getAppSelections());case 3:case"end":return e.stop()}}),e)}))),function(){return r.apply(this,arguments)})},c,i]}var lt=g((function(e){return{row:{flexWrap:"nowrap",borderBottom:"1px solid ".concat(e.palette.divider),"&:focus":{boxShadow:"inset 0 0 0 2px ".concat(e.palette.custom.focusOutline),outline:"none"}},cell:{padding:"8px","& span":{whiteSpace:"nowrap",fontSize:"12px",lineHeight:"16px"},overflow:"hidden",textOverflow:"ellipsis"},icon:{padding:e.spacing(1)},S:{background:e.palette.selected.main,color:e.palette.selected.mainContrastText,"&:focus":{boxShadow:"inset 0 0 0 2px rgba(0, 0, 0, 0.3)",outline:"none"}},A:{background:e.palette.selected.alternative,color:e.palette.selected.alternativeContrastText},X:{background:e.palette.selected.excluded,color:e.palette.selected.excludedContrastText},highlighted:{backgroundColor:"#FFC72A"}}}));function ut(e){var t,r=e.index,o=e.style,a=e.data,i=lt(),c=[i.row],s="",l=a.onClick,u=a.pages;if(u){var p=u.filter((function(e){return e.qArea.qTop<=r&&r<e.qArea.qTop+e.qArea.qHeight}))[0];if(p){var f=p.qArea;if(r>=f.qTop&&r<f.qTop+f.qHeight)t=de(p.qMatrix[r-f.qTop],1)[0]}}var m=!1,d=!1;t&&(s=t.qText,m="L"===t.qState||"XL"===t.qState,d="S"===t.qState||"XS"===t.qState,"S"===t.qState||"L"===t.qState?c.push(i.S):"A"===t.qState?c.push(i.A):"X"!==t.qState&&"XS"!==t.qState&&"XL"!==t.qState||c.push(i.X));var h=t&&t.qHighlightRanges&&t.qHighlightRanges.qRanges.sort((function(e,t){return e.qCharPos-t.qCharPos}))||[],v=h.reduce((function(e,t,n){t.qCharPos>0&&0===n&&e.push([s.slice(0,t.qCharPos)]);var r=h[n-1];return r&&e.push([s.slice(r.qCharPos+r.qCharPos+1,t.qCharPos)]),e.push([s.slice(t.qCharPos,t.qCharPos+t.qCharCount),i.highlighted]),n===h.length-1&&t.qCharPos+t.qCharCount<s.length&&e.push([s.slice(t.qCharPos+t.qCharCount)]),e}),[]);return n.createElement(R,{container:!0,spacing:0,className:c.join(" ").trim(),style:o,onClick:l,role:"row",tabIndex:0,"data-n":t&&t.qElemNumber},n.createElement(R,{item:!0,style:{minWidth:0,flexGrow:1},className:i.cell},0===h.length?n.createElement(y,{component:"span",noWrap:!0,color:"inherit"},"".concat(s)):v.map((function(e,t){var r=de(e,2),o=r[0],a=r[1];return(n.createElement(y,{component:"span",key:t,className:a,noWrap:!0},o))}))),n.createElement(R,{item:!0,className:i.icon},m&&n.createElement(z,{size:"small"}),d&&n.createElement(W,{size:"small"})))}function pt(e){var t=e.model,a=e.selections,i=e.direction,c=de(He(t),1)[0],s=de(r(null),2),p=s[0],f=s[1],m=l(null),d=l({queue:[],validPages:!1}),h=l({pages:[]}),v=u((function(e){if(!c||!c.qListObject.qDimensionInfo.qLocked){var t=+e.currentTarget.getAttribute("data-n");Number.isNaN(t)||a.select({method:"selectListObjectValues",params:["/qListObjectDef",[t],!0]})}}),[t,c&&c.qListObject.qDimensionInfo.qLocked]),E=u((function(e){if(!p||!d.current.validPages)return!1;d.current.checkIdx=e;var t=p.filter((function(t){return t.qArea.qTop<=e&&e<t.qArea.qTop+t.qArea.qHeight}))[0];return t&&t.qArea.qTop<=e&&e<t.qArea.qTop+t.qArea.qHeight}),[c,p]),g=u((function(e,n){d.current.queue.push({start:e,stop:n});var r=!!m.current&&m.current._listRef.state.isScrolling;return d.current.queue.length>10&&d.current.queue.shift(),clearTimeout(d.current.timeout),new Promise((function(e){d.current.timeout=setTimeout((function(){var n=d.current.queue.slice(-2).sort((function(e,t){return e.start-t.start}));t.getListObjectData("/qListObjectDef",n.map((function(e){return{qTop:e.start,qHeight:e.stop-e.start+1,qLeft:0,qWidth:1}}))).then((function(t){d.current.validPages=!0,h.current.pages=t,f(t),e()}))}),r?500:0)}))}),[c]);if(o((function(){if(d.current.queue=[],d.current.validPages=!1,m.current){if(m.current.resetloadMoreItemsCache(!0),c&&c.qSelectionInfo.qInSelections)return;m.current._listRef.scrollToItem(0)}}),[c]),!c)return null;var S=c.qListObject.qSize.qcy;return n.createElement(G,{isItemLoaded:E,itemCount:S,loadMoreItems:g,threshold:0,minimumBatchSize:100,ref:m},(function(e){var t=e.onItemsRendered,r=e.ref;return d.current.listRef=r,n.createElement(B,{direction:i,useIsScrolling:!0,style:{},height:264,itemCount:S,itemData:{onClick:v,pages:p},itemSize:33,onItemsRendered:t,ref:r},ut)}))}var ft=g((function(e){return{icon:{color:e.palette.text.primary}}})),mt=function(e){var t=e.item,r="function"==typeof t.enabled?!t.enabled():!!t.disabled,o=ft().icon,a="function"==typeof t.getSvgIconShape;return"menu-icon-button"===t.type?n.createElement(b,{divider:!0,title:t.label,onClick:function(){return t.action()},disabled:r},n.createElement(I,{className:o},a&&Q(t.getSvgIconShape())),n.createElement(y,null,t.label)):"button"===t.type?n.createElement(O,{title:t.label,variant:"contained",style:{backgroundColor:t.color},onClick:function(){return t.action()},disabled:r},a&&Q(t.getSvgIconShape())):n.createElement(q,{title:t.label,onClick:function(){return t.action()},disabled:r},a&&Q(t.getSvgIconShape()))},dt=n.forwardRef((function(e,t){var r=e.layout,o=e.items;return n.createElement(n.Fragment,null,o.map((function(e,o){return n.createElement(mt,{key:e.key,layout:r,item:e,ref:0===o?t:null})})))})),ht=function(e){var t=e.layout,r=e.api,o=e.xItems,a=void 0===o?[]:o,i=e.onCancel,c=void 0===i?function(){}:i,s=e.onConfirm,l=void 0===s?function(){}:s,u=p(Re).translator,f=[].concat(he(a),[{key:"clear",type:"icon-button",label:u.get("Selection.Clear"),enabled:function(){return r.canClear()},action:function(){return r.clear()},getSvgIconShape:Y},{key:"cancel",type:"icon-button",label:u.get("Selection.Cancel"),enabled:function(){return r.canCancel()},action:function(){r.cancel(),c()},getSvgIconShape:J},{key:"confirm",type:"icon-button",label:u.get("Selection.Confirm"),enabled:function(){return r.canConfirm()},action:function(){r.confirm(),l()},getSvgIconShape:H}]);return n.createElement(dt,{layout:t,items:f})},vt=g((function(e){return{root:{"& fieldset":{borderRadius:0,borderColor:"".concat(e.palette.divider," transparent")}}}}));function Et(e){var t=e.model,o=p(Re).translator,a=de(r(""),2),i=a[0],c=a[1],s=vt();return n.createElement(L,{startAdornment:n.createElement(w,{position:"start"},n.createElement(Z,null)),className:[s.root].join(" "),autoFocus:!0,margin:"dense",fullWidth:!0,placeholder:o.get("Listbox.Search"),value:i,onChange:function(e){c(e.target.value),t.searchListObjectFor("/qListObjectDef",e.target.value)},onKeyDown:function(e){switch(e.key){case"Enter":t.acceptListObjectSearch("/qListObjectDef",!0),c("");break;case"Escape":t.abortListObjectSearch("/qListObjectDef")}}})}function gt(e){var t,n,r=e.appSelections,o=e.model,a=!1,i=!1,c={id:o.id,setLayout:function(e){t=e},begin:function(e){var t,n=(t=!1,{isPrevented:function(){return t},preventDefault:function(){t=!0}});return this.emit("activate",n),n.isPrevented()?Promise.resolve():(a=!0,this.emit("activated"),r.switchModal(o,e,!0))},clear:function(){return i=!1,this.emit("cleared"),t.qListObject?o.clearSelections("/qListObjectDef"):o.resetMadeSelections()},confirm:function(){return i=!1,a=!1,this.emit("confirmed"),this.emit("deactivated"),r.switchModal(null,null,!0)},cancel:function(){return i=!1,a=!1,this.emit("canceled"),this.emit("deactivated"),r.switchModal(null,null,!1,!1)},select:function(e){var t=this,n=this.begin([e.params[0]]);return r.isModal()?(i=!0,n.then((function(){return o[e.method].apply(o,he(e.params)).then((function(e){return!!e||(t.clear(),!1)}))}))):Promise.resolve(!1)},canClear:function(){return t&&t.qListObject&&t.qListObject.qDimensionInfo?!t.qListObject.qDimensionInfo.qLocked:i||t&&t.qSelectionInfo.qMadeSelections},canConfirm:function(){return t&&t.qListObject&&t.qListObject.qDimensionInfo?!t.qListObject.qDimensionInfo.qLocked:i||t&&t.qSelectionInfo.qMadeSelections},canCancel:function(){return!(t&&t.qListObject&&t.qListObject.qDimensionInfo)||!t.qListObject.qDimensionInfo.qLocked},isActive:function(){return a},isModal:function(){return r.isModal(o)},goModal:function(e){return r.switchModal(o,e,!1)},noModal:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return r.switchModal(null,null,e)},abortModal:function(){return r.abortModal(!0)}};return n=c,Object.keys(ee.prototype).forEach((function(e){n[e]=ee.prototype[e]})),ee.init(n),c}function St(e,t){var n=de(ot(e),1)[0],r=de(He(t),1)[0],a=t?t.id:null,i=de(Ze(),1)[0],c=i.get(a);return o((function(){n&&t&&!c&&(c=gt({appSelections:n,model:t}),i.set(a,c))}),[n,t]),o((function(){c&&c.setLayout(r)}),[c,r]),[c]}function Rt(e){var t=e.alignTo,a=e.show,i=e.close,c=e.app,s=e.fieldName,f=e.stateName,m=void 0===f?"$":f,d=a&&Boolean(t.current),h=S(),v=de(_e({qInfo:{qType:"njsListbox"},qListObjectDef:{qStateName:m,qShowAlternatives:!0,qInitialDataFetch:[{qTop:0,qLeft:0,qWidth:0,qHeight:0}],qDef:{qSortCriterias:[{qSortByState:1,qSortByAscii:1,qSortByNumeric:1,qSortByLoadOrder:1}],qFieldDefs:[s]}}},c,s,m),1)[0],E=u((function(){v.lock("/qListObjectDef")}),[v]),g=u((function(){v.unlock("/qListObjectDef")}),[v]),y=p(Re).translator,b=l(),I=de(r(!1),2),O=I[0],L=I[1],w=de(St(c,v),1)[0],T=de(He(v),1)[0];if(o((function(){w&&d&&(w.isModal(v)||w.goModal("/qListObjectDef"))}),[w,d]),!v||!T||!y)return null;var A=!0===T.qListObject.qDimensionInfo.qLocked,x=function(e,t){var n="escapeKeyDown"!==t;w.noModal(n),i()},k=function(e){var t=e.layout,n=e.model,r=e.translator,o=e.onSelected,a=void 0===o?function(){}:o;return[{key:"selectAll",type:"menu-icon-button",label:r.get("Selection.SelectAll"),getSvgIconShape:V,enabled:function(){return["qOption","qAlternative","qExcluded","qDeselected"].some((function(e){return t.qListObject.qDimensionInfo.qStateCounts[e]>0}))},action:function(){n.selectListObjectAll("/qListObjectDef"),a()}},{key:"selectPossible",type:"menu-icon-button",label:r.get("Selection.SelectPossible"),getSvgIconShape:X,enabled:function(){return["qOption"].some((function(e){return t.qListObject.qDimensionInfo.qStateCounts[e]>0}))},action:function(){n.selectListObjectPossible("/qListObjectDef"),a()}},{key:"selectAlternative",type:"menu-icon-button",label:r.get("Selection.SelectAlternative"),getSvgIconShape:_,enabled:function(){return["qAlternative"].some((function(e){return t.qListObject.qDimensionInfo.qStateCounts[e]>0}))},action:function(){n.selectListObjectAlternative("/qListObjectDef"),a()}},{key:"selectExcluded",type:"menu-icon-button",label:r.get("Selection.SelectExcluded"),getSvgIconShape:K,enabled:function(){return["qAlternative","qExcluded"].some((function(e){return t.qListObject.qDimensionInfo.qStateCounts[e]>0}))},action:function(){n.selectListObjectExcluded("/qListObjectDef"),a()}}]}({layout:T,model:v,translator:y,onSelected:function(){return L(!1)}}),D={key:"more",type:"icon-button",label:y.get("Selection.Menu"),getSvgIconShape:U,enabled:function(){return!A},action:function(){return L(!O)}},j=T.qListObject.qDimensionInfo.qStateCounts,P=j.qSelected+j.qSelectedExcluded+j.qLocked+j.qLockedExcluded>0;return n.createElement(N,{open:d,onClose:x,anchorEl:t.current,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},PaperProps:{style:{minWidth:"250px"}}},n.createElement(R,{container:!0,direction:"column",spacing:0},n.createElement(R,{item:!0,container:!0,style:{padding:h.spacing(1)}},n.createElement(R,{item:!0},A?n.createElement(q,{onClick:g,disabled:!A},n.createElement(z,null)):n.createElement(q,{onClick:E,disabled:!P},n.createElement(F,null))),n.createElement(R,{item:!0,xs:!0}),n.createElement(R,{item:!0},n.createElement(ht,{layout:T,api:w,xItems:[D],onConfirm:x,onCancel:function(){return x(0,"escapeKeyDown")}}))),n.createElement(R,{item:!0,xs:!0},n.createElement("div",{ref:b}),n.createElement(Et,{model:v}),n.createElement(pt,{model:v,selections:w,direction:"ltr"}),O&&n.createElement(N,{open:O,anchorEl:b.current,getContentAnchorEl:null,container:b.current,disablePortal:!0,hideBackdrop:!0,style:{pointerEvents:"none"},transitionDuration:0,elevation:0,PaperProps:{style:{boxShadow:"0 12px 8px -8px rgba(0, 0, 0, 0.2)",minWidth:"250px",pointerEvents:"auto"}}},n.createElement(C,null,n.createElement(dt,{layout:T,items:k}))))))}var yt=g((function(e){return{item:{backgroundColor:e.palette.background.paper,position:"relative",cursor:"pointer",padding:"4px","&:hover":{backgroundColor:e.palette.action.hover}}}}));function bt(e){var t=e.field,o=e.api,a=e.stateIx,i=void 0===a?0:a,c=e.skipHandleShowListBoxPopover,s=void 0!==c&&c,u=p(Re).translator,f=l(),m=S(),d=de(r(!1),2),h=d[0],v=d[1],E=yt(),g=t.selections[i];void 0===g.qTotal&&(g.qTotal=0);var b=g.qStateCounts||{qSelected:0,qLocked:0,qExcluded:0,qLockedExcluded:0,qSelectedExcluded:0,qAlternative:0},I=(b.qSelected+b.qLocked)/g.qTotal,O=b.qAlternative/g.qTotal,L=(b.qExcluded+b.qLockedExcluded+b.qSelectedExcluded)/g.qTotal,w=b.qSelected+b.qSelectedExcluded+b.qLocked+b.qLockedExcluded,N=0===w&&0===g.qTotal,C="";g.qTotal===w&&g.qTotal>1?C=u.get("CurrentSelections.All"):w>1&&g.qTotal?C=u.get("CurrentSelections.Of",[w,g.qTotal]):g.qSelectedFieldSelectionInfo&&(C=g.qSelectedFieldSelectionInfo.map((function(e){return e.qName})).join(", ")),"$"!==t.states[i]&&(C="".concat(t.states[i],": ").concat(C));var T=[{color:m.palette.selected.main,ratio:I},{color:m.palette.selected.alternative,ratio:O},{color:m.palette.selected.excluded,ratio:L}];return T.forEach((function(e,t){e.offset=t?T[t-1].offset+T[t-1].ratio:0})),n.createElement(R,{container:!0,spacing:0,ref:f,className:E.item,onClick:!1===s&&function(e){e.currentTarget.contains(e.target)&&v(!h)}||null},n.createElement(R,{item:!0,xs:!0,style:{minWidth:0,flexGrow:1,opacity:g.qLocked?"0.3":""}},n.createElement(y,{noWrap:!0,style:{fontSize:"12px",lineHeight:"16px",fontWeight:600}},g.qField),n.createElement(y,{noWrap:!0,style:{fontSize:"12px",opacity:.55,lineHeight:"16px"}},C)),g.qLocked?n.createElement(R,{item:!0},n.createElement(q,null,n.createElement(z,null))):n.createElement(R,{item:!0},n.createElement(q,{title:u.get("Selection.Clear"),onClick:function(e){e.stopPropagation(),o.clearField(g.qField,t.states[i])},style:{zIndex:1}},n.createElement(M,null))),n.createElement("div",{style:{height:"4px",position:"absolute",bottom:"0",left:"0",width:"100%"}},!1===N&&T.map((function(e){return n.createElement("div",{key:e.color,style:{position:"absolute",background:e.color,height:"100%",top:0,width:"".concat(100*e.ratio,"%"),left:"".concat(100*e.offset,"%")}})}))),h&&n.createElement(Rt,{alignTo:f,show:h,close:function(){return v(!1)},app:o.model,fieldName:g.qField,stateName:t.states[i]}))}var It=g((function(e){return{item:{backgroundColor:e.palette.background.paper,position:"relative",cursor:"pointer",padding:"4px","&:hover":{backgroundColor:e.palette.action.hover},height:"100%",alignItems:"center"},badge:{padding:e.spacing(0,1)}}}));function Ot(e){var t=e.field,o=e.api,a=It(),i=de(r(!1),2),c=i[0],s=i[1],u=de(r(-1),2),f=u[0],m=u[1],d=de(r(null),2),h=d[0],v=d[1],E=l(),g=p(Re).translator.get("Selection.ClearAllStates");return n.createElement(R,{container:!0,spacing:0,className:a.item,onClick:function(e){e.currentTarget.contains(e.target)&&(v(e.currentTarget),E.current=e.currentTarget,s(!c))}},n.createElement(R,{item:!0,xs:!0},n.createElement(T,{className:a.badge,color:"secondary",badgeContent:t.states.length},n.createElement(y,{component:"span",noWrap:!0,style:{fontSize:"12px",lineHeight:"16px",fontWeight:600}},t.name))),n.createElement(R,{item:!0},n.createElement("div",{style:{width:"12px"}})),n.createElement(R,{item:!0},n.createElement(q,null,n.createElement(te,null))),c&&n.createElement(N,{open:c,onClose:function(){return s(!1)},anchorEl:h,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},PaperProps:{style:{minWidth:"200px",width:"200px",pointerEvents:"auto"}}},n.createElement(A,{dense:!0},n.createElement(x,{title:g,onClick:function(){t.states.forEach((function(e){return o.clearField(t.name,e)}))}},n.createElement(O,{variant:"contained",fullWidth:!0},g)),t.states.map((function(e,r){return n.createElement(x,{key:r,title:t.name,onClick:function(e){return function(e,t){e.stopPropagation(),s(!1),m(t)}(e,r)}},n.createElement(k,{border:1,width:"100%",borderRadius:"borderRadius",borderColor:"divider"},n.createElement(bt,{field:t,api:o,stateIx:r,skipHandleShowListBoxPopover:!0})))})))),f>-1&&n.createElement(Rt,{alignTo:E,show:f>-1,close:function(){return m(-1)},app:o.model,fieldName:t.selections[f].qField,stateName:t.states[f]}))}function qt(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"$";e.qSelections.forEach((function(e){var r=e.qField,o=t[r]=t[r]||{name:r,states:[],selections:[]};-1===o.states.indexOf(n)&&(o.states.push(n),o.selections.push(e))}))}function Lt(e){var t=e.api,a=e.app,i=S(),c=de(Ke(a),1)[0],s=de(He(c),1)[0],l=de(r({items:[]}),2),u=l[0],p=l[1],f=de(nt(),1)[0];return o((function(){if(a&&c&&s){var e=function(e){if(!e)return[];var t={};return e.qSelectionObject&&qt(e.qSelectionObject,t),e.alternateStates&&e.alternateStates.forEach((function(e){return qt(e.qSelectionObject,t,e.stateName)})),Object.keys(t).map((function(e){return t[e]}))}(s);p((function(t){var n,r=e;if((n=f.get(a.id))&&"njsListbox"===n.genericType&&r.length+1===t.items.length){var o=t.items.filter((function(e){return!1===r.some((function(t){return e.name===t.name}))}))[0],i=o.selections[0].qField;o.selections=[{qField:i}];var c=t.items.indexOf(o);r.splice(c,0,o)}return{items:r}}))}}),[a,c,s,t.isInModal()]),n.createElement(R,{container:!0,spacing:0,wrap:"nowrap",style:{height:"100%"}},u.items.map((function(e){return n.createElement(R,{item:!0,key:"".concat(e.states.join("::"),"::").concat(e.name),style:{position:"relative",maxWidth:"240px",minWidth:"120px",background:i.palette.background.paper,borderRight:"1px solid ".concat(i.palette.divider)}},e.states.length>1?n.createElement(Ot,{field:e,api:t}):n.createElement(bt,{field:e,api:t}))})))}function wt(e){var t=e.api,r=e.app,o=p(Re).translator,a=de(Je(r),1)[0];return n.createElement(R,{container:!0,wrap:"nowrap",style:{height:"100%",alignItems:"center",padding:"0 8px"}},n.createElement(R,{item:!0},n.createElement(q,{style:{marginRight:"8px"},disabled:!a||!a.canGoBack,title:o.get("Navigate.Back"),onClick:function(){return t.back()}},n.createElement(ne,null))),n.createElement(R,{item:!0},n.createElement(q,{style:{marginRight:"8px"},disabled:!a||!a.canGoForward,title:o.get("Navigate.Forward"),onClick:function(){return t.forward()}},n.createElement(re,null))),n.createElement(R,{item:!0},n.createElement(q,{disabled:!a||!a.canClear,title:o.get("Selection.ClearAll"),onClick:function(){return t.clear()}},n.createElement($,null))))}var Nt=function(e){var t=e.app,r=S(),o=de(ot(t),1)[0];return o?n.createElement(R,{container:!0,spacing:0,wrap:"nowrap",style:{backgroundColor:r.palette.background.paper,minHeight:"40px"}},n.createElement(R,{item:!0,style:{borderRight:"1px solid ".concat(r.palette.divider)}},n.createElement(wt,{api:o,app:t})),n.createElement(R,{item:!0,xs:!0,style:{backgroundColor:r.palette.background.darker,overflow:"hidden"}},n.createElement(Lt,{api:o,app:t}))):null};function Ct(e){var t=e.element,r=e.app;return m.createPortal(n.createElement(Nt,{app:r}),t)}var Tt=[[10,31],[0,31],[0,31],[0,31],[0,31],[0,31]];function At(e){var t=de(e,2),n=t[0],r=t[1];return(n+(Math.random()*(r-n)|0)).toString(32)}function xt(){return Tt.map(At).join("")}function kt(e,t){for(var n=0;n<e.length;++n)e[n]>=0&&e[n]>=t&&++e[n];e.push(t)}function Dt(e,t){for(var n=0,r=0;r<e.length;++r)e[r]>t?--e[r]:e[r]===t&&(n=r);return e.splice(n,1),n}function jt(e,t){var n=e.sn,r=e.properties,o=e.fields;if(o.length){var a=n.qae.data.targets[0];if(a){for(var i=a.propertyPath.split("/"),c=r,s=0;s<i.length;s++){var l=i[s];c=l?c[l]:c}var u=function(e){var t=e.hc,n=e.def,r=e.properties;t.qDimensions=t.qDimensions||[],t.qMeasures=t.qMeasures||[],t.qInterColumnSortOrder=t.qInterColumnSortOrder||[];var o=r,a={dimensions:function(){return t.qDimensions},measures:function(){return t.qMeasures},addDimension:function(e){var r="string"==typeof e?{qDef:{qFieldDefs:[e],qSortCriterias:[{qSortByLoadOrder:1,qSortByNumeric:1,qSortByAscii:1}]}}:fe({},e,{qDef:e.qDef||{}});r.qDef.cId=r.qDef.cId||xt(),r.qDef.cId||(r.qDef.cId=xt()),t.qDimensions.length<a.maxDimensions()?(t.qDimensions.push(r),kt(t.qInterColumnSortOrder,t.qDimensions.length-1),n.dimensions.added(r,o)):(t.qLayoutExclude=t.qLayoutExclude||{},t.qLayoutExclude.qHyperCubeDef=t.qLayoutExclude.qHyperCubeDef||{},t.qLayoutExclude.qHyperCubeDef.qDimensions=t.qLayoutExclude.qHyperCubeDef.qDimensions||[],t.qLayoutExclude.qHyperCubeDef.qMeasures=t.qLayoutExclude.qHyperCubeDef.qMeasures||[],t.qLayoutExclude.qHyperCubeDef.qDimensions.push(r))},removeDimension:function(e){var r=t.qDimensions.splice(e,1)[0];Dt(t.qInterColumnSortOrder,e),n.dimensions.removed(r,o,e)},addMeasure:function(e){var r="string"==typeof e?{qDef:{qDef:e},qSortBy:{qSortByLoadOrder:1,qSortByNumeric:-1}}:fe({},e,{qDef:e.qDef||{}});r.qDef.cId=r.qDef.cId||xt(),r.qDef.cId||(r.qDef.cId=xt()),t.qMeasures.length<a.maxMeasures()?(t.qMeasures.push(r),kt(t.qInterColumnSortOrder,t.qDimensions.length+t.qMeasures.length-1),n.measures.added(r,o)):(t.qLayoutExclude=t.qLayoutExclude||{},t.qLayoutExclude.qHyperCubeDef=t.qLayoutExclude.qHyperCubeDef||{},t.qLayoutExclude.qHyperCubeDef.qDimensions=t.qLayoutExclude.qHyperCubeDef.qDimensions||[],t.qLayoutExclude.qHyperCubeDef.qMeasures=t.qLayoutExclude.qHyperCubeDef.qMeasures||[],t.qLayoutExclude.qHyperCubeDef.qMeasures.push(r))},removeMeasure:function(e){var r=t.qMeasures.splice(e,1)[0];Dt(t.qInterColumnSortOrder,t.qDimensions.length+e),n.measures.removed(r,o,e)},maxDimensions:function(){return n.dimensions.max(t.qMeasures.length)},maxMeasures:function(){return n.measures.max(t.qDimensions.length)},canAddDimension:function(){return t.qDimensions.length<a.maxDimensions()},canAddMeasure:function(){return t.qMeasures.length<a.maxMeasures()}};return a}({hc:c,def:a,properties:r});o.forEach((function(e){"measure"===function(e){return"string"==typeof e&&"="===e[0]||"object"===ie(e)&&e.qDef&&e.qDef.qDef||"object"===ie(e)&&e.qLibraryId&&"measure"===e.type?"measure":"dimension"}(e)?u.addMeasure(e):u.addDimension(e)}))}else t.logger.warn("Attempting to add fields to an object without a specified data target")}}var Pt=D((function(){return{contentError:{"&::before":{position:"absolute",height:"100%",width:"100%",top:0,left:0,content:'""',backgroundSize:"14.14px 14.14px",backgroundImage:"linear-gradient(135deg, currentColor 10%, rgba(0,0,0,0) 10%, rgba(0,0,0,0) 50%, currentColor 50%, currentColor 59%, rgba(0,0,0,0) 60%, rgba(0,0,0,0) 103%)",opacity:.1}}}}));function Mt(e){var t=e.title,r=void 0===t?"Error":t,o=e.message,a=void 0===o?"":o,i=e.data,c=void 0===i?[]:i,s=Pt().contentError;return n.createElement(R,{container:!0,direction:"column",alignItems:"center",justify:"center",className:s,style:{position:"relative",height:"100%"},spacing:1},n.createElement(R,{item:!0},n.createElement(oe,{style:{fontSize:"38px"}})),n.createElement(R,{item:!0},n.createElement(y,{variant:"h6",align:"center","data-tid":"error-title"},r)),n.createElement(R,{item:!0},n.createElement(y,{variant:"subtitle1",align:"center","data-tid":"error-message"},a)),n.createElement(R,{item:!0},c.map((function(e,t){return n.createElement(y,{key:t,variant:"subtitle2",align:"center"},e.path," ",e.error&&"-"," ",e.error&&e.error.qErrorCode)}))))}var zt=g((function(e){return{root:{position:"relative",display:"inline-block"},front:{color:e.palette.secondary.main,animationDuration:"1500ms",position:"absolute",left:0},back:{color:e.palette.divider}}})),Ft={small:16,medium:32,large:64,xlarge:128};function Ut(e){var t=e.size,r=void 0===t?"medium":t,o=me(e,["size"]),a=zt(),i=Ft[r];return n.createElement("div",{className:a.root},n.createElement(j,ue({variant:"determinate",value:100,className:a.back,size:i,thickness:3},o)),n.createElement(j,ue({variant:"indeterminate",disableShrink:!0,className:a.front,size:i,thickness:3},o)))}var Bt=D((function(){return{stripes:{"&::before":{position:"absolute",height:"100%",width:"100%",top:0,left:0,content:'""',backgroundSize:"14.14px 14.14px",backgroundImage:"linear-gradient(135deg, currentColor 10%, rgba(0,0,0,0) 10%, rgba(0,0,0,0) 50%, currentColor 50%, currentColor 59%, rgba(0,0,0,0) 60%, rgba(0,0,0,0) 103%)",opacity:.1}}}})),Gt=function(e){var t=e.cancel,r=e.translator,o=me(e,["cancel","translator"]);return n.createElement(n.Fragment,null,n.createElement(R,{container:!0,item:!0,direction:"column",alignItems:"center",spacing:2},n.createElement(R,{item:!0},n.createElement(Ut,null)),n.createElement(R,{item:!0},n.createElement(y,{variant:"h6",align:"center"},r.get("Object.Update.Active")))),n.createElement(R,ue({item:!0},o),n.createElement(O,{variant:"contained",onClick:t},r.get("Common.Cancel"))))},Wt=function(e){var t=e.retry,r=e.translator,o=me(e,["retry","translator"]);return n.createElement(n.Fragment,null,n.createElement(R,{item:!0},n.createElement(oe,{style:{fontSize:"38px"}})),n.createElement(R,{item:!0},n.createElement(y,{variant:"h6",align:"center"},r.get("Object.Update.Cancelled"))),n.createElement(R,{item:!0},n.createElement(O,ue({variant:"contained",onClick:t},o),r.get("Common.Retry"))))};function Ht(e){var t=e.canCancel,r=e.canRetry,o=e.api,a=Bt(),i=a.stripes,c=a.cancel,s=a.retry,l=p(Re).translator;return n.createElement(R,{container:!0,direction:"column",alignItems:"center",justify:"center",className:i,style:{position:"absolute",width:"100%",height:"100%",left:0,top:0},spacing:2},t&&n.createElement(Gt,{cancel:o.cancel,translator:l,className:c}),r&&n.createElement(Wt,{retry:o.retry,translator:l,className:s}))}function Vt(){return n.createElement(R,{container:!0,direction:"column",alignItems:"center",justify:"center",style:{position:"absolute",width:"100%",height:"100%",left:0,top:0},spacing:2},n.createElement(Ut,{size:"large"}))}var _t=function(e){var t=e.layout,a=e.sn,i=t&&t.showTitles&&!!t.title,c=t&&t.showTitles&&!!t.subtitle,s=a&&t&&t.qSelectionInfo&&t.qSelectionInfo.qInSelections,l=de(r([]),2),u=l[0],p=l[1];return o((function(){a&&a.component&&a.component.isHooked&&a.component.observeActions((function(e){return p(e)}))}),[a]),n.createElement(R,{item:!0,container:!0,wrap:"nowrap",style:{flexGrow:0}},n.createElement(R,{item:!0,zeroMinWidth:!0,xs:!0},n.createElement(R,{container:!0,wrap:"nowrap",direction:"column"},i&&n.createElement(y,{variant:"h6",noWrap:!0},t.title),c&&n.createElement(y,{variant:"body2",noWrap:!0},t.subtitle))),n.createElement(R,{item:!0,style:{whiteSpace:"nowrap",minHeight:"32px"}},s&&n.createElement(ht,{inline:!0,layout:t,api:a.component.selections,xItems:[].concat(he(u),he(a.selectionToolbar.items||[]))})))},Xt=function(e){var t=e.layout;return t&&t.showTitles&&t.footnote?n.createElement(R,{container:!0},n.createElement(R,{item:!0,style:{minWidth:0}},n.createElement(y,{noWrap:!0,variant:"body2"},t.footnote))):null};function Kt(){var e=de(r(),2),t=e[0],n=e[1],o=de(r(),2),a=o[0],i=o[1],c=u((function(e){e&&n(e)}),[]),s=function(){var e=t.getBoundingClientRect(),n=e.left,r=e.top,o=e.width,a=e.height;i({left:n,top:r,width:o,height:a})};return f((function(){if(t){if("function"==typeof ResizeObserver){var e=new ResizeObserver(s);return e.observe(t),function(){e.unobserve(t),e.disconnect(t),e=null}}return window.addEventListener("resize",s),function(){window.removeEventListener("resize",s)}}}),[t]),[c,a,t]}var Jt=function(e){var t=e.sn,a=e.snOptions,i=e.layout,c=e.appLayout,s=e.corona,f=t.component,m=p(Re),d=m.theme,h=m.language,v=m.constraints,E=l(null),g=de(r(!1),2),S=g[0],R=g[1],y=de(r(0),2),b=y[0],I=y[1],O=de(Kt(),3),q=O[0],L=O[1],w=O[2],N=de(r(null),2),C=N[0],T=N[1],A=u((function(e){e&&T(e)}),[]);return o((function(){if(C)return f.created({options:a}),f.mounted(C),R(!0),function(){clearTimeout(E.current),E.current=null,f.willUnmount()}}),[C,f]),o((function(){S&&C&&w&&(!f.isHooked&&i&&i.qSelectionInfo&&i.qSelectionInfo.qInSelections||E.current||(E.current=setTimeout((function(){var e=[];v.passive||e.push("passive"),v.active||e.push("interact"),v.select||e.push("select"),s.app&&s.app.session&&e.push("fetch"),Promise.resolve(f.render({layout:i,options:a,context:fe({constraints:v,theme:s.public.theme,appLayout:c},f.isHooked?{}:{logicalSize:t.logicalSize({layout:i}),localeInfo:(c||{}).qLocaleInfo,permissions:e})})).then((function(){E.current=null,0===b&&"function"==typeof a.onInitialRender&&a.onInitialRender.call(null),I(b+1)}))}),10)))}),[L,a,C,w,i,c,d,h,v,S]),n.createElement("div",{ref:q,"data-render-count":b,style:{position:"relative",height:"100%"},className:"nebulajs-sn"},n.createElement("div",{ref:A,style:{position:"absolute",width:"100%",height:"100%"}}))},$t=function(e,t){switch(t.type){case"LOADING":return fe({},e,{loading:!0});case"LOADED":return fe({},e,{loaded:!0,loading:!1,longRunningQuery:!1,error:null,sn:t.sn});case"RENDER":return fe({},e,{loaded:!0,loading:!1,longRunningQuery:!1,error:null});case"LONG_RUNNING_QUERY":return fe({},e,{longRunningQuery:!0});case"ERROR":return fe({},e,{loading:!1,longRunningQuery:!1,error:t.error});default:throw new Error("Unhandled type: ".concat(t.type))}},Yt=function(e){var t=e.delay,a=void 0===t?750:t,i=de(r(!1),2),c=i[0],s=i[1];return o((function(){var e=setTimeout((function(){return s(!0)}),a);return function(){return clearTimeout(e)}}),[]),c&&n.createElement(Vt,null)},Qt=function(e){return!e.qError||7005===e.qError.qErrorCode},Zt=function(){var e=se(regeneratorRuntime.mark((function e(t){var n,r,o,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.types,r=t.name,o=t.version,e.next=3,n.get({name:r,version:o}).supernova();case 3:return a=e.sent,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),en=function(){var e=se(regeneratorRuntime.mark((function e(t){var n,r,o,a,i,c,s,l,u,p;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.dispatch,r=t.types,o=t.name,a=t.version,i=t.layout,c=t.model,s=t.app,l=t.selections,e.prev=1,e.next=4,Zt({types:r,name:o,version:a});case 4:if(u=e.sent,i.visualization===o){e.next=7;break}return e.abrupt("return",void 0);case 7:return p=u.create({model:c,app:s,selections:l}),e.abrupt("return",p);case 11:e.prev=11,e.t0=e.catch(1),n({type:"ERROR",error:{title:e.t0.message}});case 14:return e.abrupt("return",void 0);case 15:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t){return e.apply(this,arguments)}}(),tn=i((function(e,t){var i,c=e.corona,u=e.model,f=e.initialSnOptions,m=e.initialError,d=e.onMount,h=c.app,v=c.public.nebbie.types,E=p(Re),g=E.translator,y=E.language,b=S(),I=l(),O=de(a($t,{loading:!1,loaded:!1,longRunningQuery:!1,error:(i=m)?{title:i.message}:null,sn:null}),2),q=O[0],L=O[1],w=de(He(u),3),N=w[0],C=w[1],T=C.validating,A=C.canCancel,x=C.canRetry,k=w[2],D=de(Ve(h),1)[0],j=de(Kt(),4),M=j[0],z=j[1],F=j[3],U=de(r(f),2),B=U[0],G=U[1],W=de(St(h,u),1)[0];o((function(){if(!m&&D){var e=function(){var e=se(regeneratorRuntime.mark((function e(t,n){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,en({dispatch:L,types:v,name:t.visualization,version:n,layout:N,model:u,app:h,selections:W});case 2:return(r=e.sent)&&(L({type:"LOADED",sn:r}),d()),e.abrupt("return",void 0);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();if(N){if(q.sn)return t=q.sn,n=de(function(e,t,n){var r=n.targets,o=[],a=[];return r.forEach((function(e){var n=e.dimensions.min(),r=e.measures.min(),i=e.resolveLayout(t),c=(i.qDimensionInfo||[]).filter(Qt),s=(i.qMeasureInfo||[]).filter(Qt),l=e.layoutPath;i.qError&&o.push({path:l,error:i.qError}),(c.length<n||s.length<r)&&a.push({path:l})})),[!(!o.length&&!a.length),{title:a.length?e.get("Supernova.Incomplete"):"Error",data:a.length?a:o}]}(g,N,t.generator.qae.data),2),r=n[0],o=n[1],void L(r?{type:"ERROR",error:o}:{type:"RENDER"});var t,n,r,o,a=v.getSupportedVersion(N.visualization,N.version);if(a)return e(N,a),function(){};L({type:"ERROR",error:{title:"Could not find a version of '".concat(N.visualization,"' that supports current object version. Did you forget to register ").concat(N.visualization,"?")}})}else L({type:"LOADING"})}}),[v,q.sn,u,N,D,y]),o((function(){if(T){var e=setTimeout((function(){return L({type:"LONG_RUNNING_QUERY"})}),2e3);return function(){return clearTimeout(e)}}}),[T]),s(t,(function(){return{setSnOptions:G,takeSnapshot:function(){return se(regeneratorRuntime.mark((function e(){var t,n,r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=I.current.getBoundingClientRect(),n=t.width,r=t.height,o=JSON.parse(JSON.stringify(N)),"function"!=typeof q.sn.component.setSnapshotData){e.next=9;break}return e.next=5,q.sn.component.setSnapshotData(o);case 5:if(e.t0=e.sent,e.t0){e.next=8;break}e.t0=o;case 8:o=e.t0;case 9:return e.abrupt("return",{key:String(+Date.now()),meta:{language:g.language(),theme:b.name,appLayout:D,size:{width:Math.round(n),height:Math.round(r)}},layout:o});case 10:case"end":return e.stop()}}),e)})))()},exportImage:function(){var e=this;return se(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(c.config.snapshot.capture){t.next=2;break}throw new Error("Nebula has not been configured with snapshot.capture");case 2:return t.next=4,e.takeSnapshot();case 4:return n=t.sent,t.abrupt("return",c.config.snapshot.capture(n));case 6:case"end":return t.stop()}}),t)})))()}}}),[q.sn,z,N,b.name,D]);var H=null;return q.loading?H=n.createElement(Yt,null):q.error?H=n.createElement(Mt,q.error):q.loaded&&(H=n.createElement(Jt,{key:N.visualization,sn:q.sn,corona:c,snOptions:B,layout:N,appLayout:D,parentNode:F})),n.createElement(P,{style:{position:"relative",width:"100%",height:"100%",overflow:"hidden"},elevation:0,square:!0,className:"nebulajs-cell",ref:I},n.createElement(R,{container:!0,direction:"column",spacing:0,style:fe({position:"relative",width:"100%",height:"100%",padding:b.spacing(1)},q.longRunningQuery?{opacity:"0.3"}:{})},n.createElement(_t,{layout:N,sn:q.sn}," "),n.createElement(R,{item:!0,xs:!0,style:{height:"100%"},ref:M},H),n.createElement(Xt,{layout:N})),q.longRunningQuery&&n.createElement(Ht,{canCancel:A,canRetry:x,api:k}))}));function nn(e){var t=e.corona,r=e.element,o=e.model,a=e.initialSnOptions,i=e.onMount,c=e.initialError,s=t.root,l=n.createRef(),u=m.createPortal(n.createElement(tn,{ref:l,corona:t,model:o,initialSnOptions:a,initialError:c,onMount:i}),r,o.id),p=function(){s.remove(u)};return o.once("closed",p),s.add(u),[function(){p()},l]}function rn(e){return null!=e&&!Array.isArray(e)&&"object"===ie(e)}function on(e,t){return rn(e)&&rn(t)?JSON.stringify(e)===JSON.stringify(t):!Array.isArray(e)&&!Array.isArray(t)&&e===t}function an(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"/",t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,r=[];return Object.keys(t).forEach((function(o){var a=t[o];"object"!==ie(n[o])||"object"!==ie(a)||Array.isArray(a)?on(a,n[o])||r.push({qPath:e+o,qOp:"add",qValue:JSON.stringify(t[o])}):r.push.apply(r,he(an("".concat(e).concat(o,"/"),t[o],n[o])))})),r}var cn=function(){};function sn(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.model,n=e.corona,r=e.initialError,o=cn,a=null,i=null,c=null,s=new Promise((function(e){c=e})),l={},u=function(){var e=se(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i?se(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s;case 2:a.current.setSnOptions(fe({},l,{},t));case 3:case"end":return e.stop()}}),e)})))():l=fe({},l,{},t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),p={model:t,mount:function(e){if(i)throw new Error("Already mounted");i=e;var u=de(nn({corona:n,element:e,model:t,initialSnOptions:l,initialError:r,onMount:c}),2);return o=u[0],a=u[1],s},close:function(){t.emit("closed"),o(),o=cn},setTemporaryProperties:function(e){return se(regeneratorRuntime.mark((function n(){var r,o;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.getEffectiveProperties();case 2:if(r=n.sent,!(o=an("/",e,r)).length){n.next=6;break}return n.abrupt("return",t.applyPatches(o,!0));case 6:return n.abrupt("return",void 0);case 7:case"end":return n.stop()}}),n)})))()},options:function(e){u(e)},exportImage:function(){return a.current.exportImage()},takeSnapshot:function(){return a.current.takeSnapshot()}};return p}function ln(e,t,n,r){return un.apply(this,arguments)}function un(){return(un=se(regeneratorRuntime.mark((function e(t,n,r,o){var a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=sn({model:t,corona:r,initialError:o}),n.options&&a.options(n.options),!n.element){e.next=5;break}return e.next=5,a.mount(n.element);case 5:return e.abrupt("return",a);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function pn(e,t,n){return fn.apply(this,arguments)}function fn(){return(fn=se(regeneratorRuntime.mark((function e(t,n,r){var o,a,i,c,s,l,u,p;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=t.type,a=t.version,i=t.fields,c={},e.prev=2,l=r.public.nebbie.types.get({name:o,version:a}),e.next=6,l.initialProperties(n.properties);case 6:return c=e.sent,e.next=9,l.supernova();case 9:u=e.sent,i&&jt({sn:u,properties:c,fields:i},r),n.properties&&u&&u.qae.properties.onChange&&u.qae.properties.onChange.call({},c),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(2),s=e.t0,c={qInfo:{qType:o},visualization:o};case 18:return e.next=20,r.app.createSessionObject(c);case 20:return p=e.sent,Be(p),e.abrupt("return",ln(p,n,r,s));case 23:case"end":return e.stop()}}),e,null,[[2,14]])})))).apply(this,arguments)}function mn(e,t,n){return dn.apply(this,arguments)}function dn(){return(dn=se(regeneratorRuntime.mark((function e(t,n,r){var o,a,i,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=t.id,a="".concat(o),(i=xe.get(a))||(i=r.app.getObject(o),xe.set(a,i)),e.next=6,i;case 6:return c=e.sent,Ue.set(a,c),e.abrupt("return",ln(c,n,r));case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var hn=function(e,t){return e(t={exports:{}},t.exports),t.exports}((function(e,t){var n;t=e.exports=p,n="object"==typeof process&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?function(){var e=Array.prototype.slice.call(arguments,0);e.unshift("SEMVER"),console.log.apply(console,e)}:function(){},t.SEMVER_SPEC_VERSION="2.0.0";var r=Number.MAX_SAFE_INTEGER||9007199254740991,o=t.re=[],a=t.src=[],i=t.tokens={},c=0;function s(e){i[e]=c++}s("NUMERICIDENTIFIER"),a[i.NUMERICIDENTIFIER]="0|[1-9]\\d*",s("NUMERICIDENTIFIERLOOSE"),a[i.NUMERICIDENTIFIERLOOSE]="[0-9]+",s("NONNUMERICIDENTIFIER"),a[i.NONNUMERICIDENTIFIER]="\\d*[a-zA-Z-][a-zA-Z0-9-]*",s("MAINVERSION"),a[i.MAINVERSION]="("+a[i.NUMERICIDENTIFIER]+")\\.("+a[i.NUMERICIDENTIFIER]+")\\.("+a[i.NUMERICIDENTIFIER]+")",s("MAINVERSIONLOOSE"),a[i.MAINVERSIONLOOSE]="("+a[i.NUMERICIDENTIFIERLOOSE]+")\\.("+a[i.NUMERICIDENTIFIERLOOSE]+")\\.("+a[i.NUMERICIDENTIFIERLOOSE]+")",s("PRERELEASEIDENTIFIER"),a[i.PRERELEASEIDENTIFIER]="(?:"+a[i.NUMERICIDENTIFIER]+"|"+a[i.NONNUMERICIDENTIFIER]+")",s("PRERELEASEIDENTIFIERLOOSE"),a[i.PRERELEASEIDENTIFIERLOOSE]="(?:"+a[i.NUMERICIDENTIFIERLOOSE]+"|"+a[i.NONNUMERICIDENTIFIER]+")",s("PRERELEASE"),a[i.PRERELEASE]="(?:-("+a[i.PRERELEASEIDENTIFIER]+"(?:\\."+a[i.PRERELEASEIDENTIFIER]+")*))",s("PRERELEASELOOSE"),a[i.PRERELEASELOOSE]="(?:-?("+a[i.PRERELEASEIDENTIFIERLOOSE]+"(?:\\."+a[i.PRERELEASEIDENTIFIERLOOSE]+")*))",s("BUILDIDENTIFIER"),a[i.BUILDIDENTIFIER]="[0-9A-Za-z-]+",s("BUILD"),a[i.BUILD]="(?:\\+("+a[i.BUILDIDENTIFIER]+"(?:\\."+a[i.BUILDIDENTIFIER]+")*))",s("FULL"),s("FULLPLAIN"),a[i.FULLPLAIN]="v?"+a[i.MAINVERSION]+a[i.PRERELEASE]+"?"+a[i.BUILD]+"?",a[i.FULL]="^"+a[i.FULLPLAIN]+"$",s("LOOSEPLAIN"),a[i.LOOSEPLAIN]="[v=\\s]*"+a[i.MAINVERSIONLOOSE]+a[i.PRERELEASELOOSE]+"?"+a[i.BUILD]+"?",s("LOOSE"),a[i.LOOSE]="^"+a[i.LOOSEPLAIN]+"$",s("GTLT"),a[i.GTLT]="((?:<|>)?=?)",s("XRANGEIDENTIFIERLOOSE"),a[i.XRANGEIDENTIFIERLOOSE]=a[i.NUMERICIDENTIFIERLOOSE]+"|x|X|\\*",s("XRANGEIDENTIFIER"),a[i.XRANGEIDENTIFIER]=a[i.NUMERICIDENTIFIER]+"|x|X|\\*",s("XRANGEPLAIN"),a[i.XRANGEPLAIN]="[v=\\s]*("+a[i.XRANGEIDENTIFIER]+")(?:\\.("+a[i.XRANGEIDENTIFIER]+")(?:\\.("+a[i.XRANGEIDENTIFIER]+")(?:"+a[i.PRERELEASE]+")?"+a[i.BUILD]+"?)?)?",s("XRANGEPLAINLOOSE"),a[i.XRANGEPLAINLOOSE]="[v=\\s]*("+a[i.XRANGEIDENTIFIERLOOSE]+")(?:\\.("+a[i.XRANGEIDENTIFIERLOOSE]+")(?:\\.("+a[i.XRANGEIDENTIFIERLOOSE]+")(?:"+a[i.PRERELEASELOOSE]+")?"+a[i.BUILD]+"?)?)?",s("XRANGE"),a[i.XRANGE]="^"+a[i.GTLT]+"\\s*"+a[i.XRANGEPLAIN]+"$",s("XRANGELOOSE"),a[i.XRANGELOOSE]="^"+a[i.GTLT]+"\\s*"+a[i.XRANGEPLAINLOOSE]+"$",s("COERCE"),a[i.COERCE]="(^|[^\\d])(\\d{1,16})(?:\\.(\\d{1,16}))?(?:\\.(\\d{1,16}))?(?:$|[^\\d])",s("COERCERTL"),o[i.COERCERTL]=new RegExp(a[i.COERCE],"g"),s("LONETILDE"),a[i.LONETILDE]="(?:~>?)",s("TILDETRIM"),a[i.TILDETRIM]="(\\s*)"+a[i.LONETILDE]+"\\s+",o[i.TILDETRIM]=new RegExp(a[i.TILDETRIM],"g");s("TILDE"),a[i.TILDE]="^"+a[i.LONETILDE]+a[i.XRANGEPLAIN]+"$",s("TILDELOOSE"),a[i.TILDELOOSE]="^"+a[i.LONETILDE]+a[i.XRANGEPLAINLOOSE]+"$",s("LONECARET"),a[i.LONECARET]="(?:\\^)",s("CARETTRIM"),a[i.CARETTRIM]="(\\s*)"+a[i.LONECARET]+"\\s+",o[i.CARETTRIM]=new RegExp(a[i.CARETTRIM],"g");s("CARET"),a[i.CARET]="^"+a[i.LONECARET]+a[i.XRANGEPLAIN]+"$",s("CARETLOOSE"),a[i.CARETLOOSE]="^"+a[i.LONECARET]+a[i.XRANGEPLAINLOOSE]+"$",s("COMPARATORLOOSE"),a[i.COMPARATORLOOSE]="^"+a[i.GTLT]+"\\s*("+a[i.LOOSEPLAIN]+")$|^$",s("COMPARATOR"),a[i.COMPARATOR]="^"+a[i.GTLT]+"\\s*("+a[i.FULLPLAIN]+")$|^$",s("COMPARATORTRIM"),a[i.COMPARATORTRIM]="(\\s*)"+a[i.GTLT]+"\\s*("+a[i.LOOSEPLAIN]+"|"+a[i.XRANGEPLAIN]+")",o[i.COMPARATORTRIM]=new RegExp(a[i.COMPARATORTRIM],"g");s("HYPHENRANGE"),a[i.HYPHENRANGE]="^\\s*("+a[i.XRANGEPLAIN]+")\\s+-\\s+("+a[i.XRANGEPLAIN]+")\\s*$",s("HYPHENRANGELOOSE"),a[i.HYPHENRANGELOOSE]="^\\s*("+a[i.XRANGEPLAINLOOSE]+")\\s+-\\s+("+a[i.XRANGEPLAINLOOSE]+")\\s*$",s("STAR"),a[i.STAR]="(<|>)?=?\\s*\\*";for(var l=0;l<c;l++)n(l,a[l]),o[l]||(o[l]=new RegExp(a[l]));function u(e,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof p)return e;if("string"!=typeof e)return null;if(e.length>256)return null;if(!(t.loose?o[i.LOOSE]:o[i.FULL]).test(e))return null;try{return new p(e,t)}catch(e){return null}}function p(e,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof p){if(e.loose===t.loose)return e;e=e.version}else if("string"!=typeof e)throw new TypeError("Invalid Version: "+e);if(e.length>256)throw new TypeError("version is longer than 256 characters");if(!(this instanceof p))return new p(e,t);n("SemVer",e,t),this.options=t,this.loose=!!t.loose;var a=e.trim().match(t.loose?o[i.LOOSE]:o[i.FULL]);if(!a)throw new TypeError("Invalid Version: "+e);if(this.raw=e,this.major=+a[1],this.minor=+a[2],this.patch=+a[3],this.major>r||this.major<0)throw new TypeError("Invalid major version");if(this.minor>r||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>r||this.patch<0)throw new TypeError("Invalid patch version");a[4]?this.prerelease=a[4].split(".").map((function(e){if(/^[0-9]+$/.test(e)){var t=+e;if(t>=0&&t<r)return t}return e})):this.prerelease=[],this.build=a[5]?a[5].split("."):[],this.format()}t.parse=u,t.valid=function(e,t){var n=u(e,t);return n?n.version:null},t.clean=function(e,t){var n=u(e.trim().replace(/^[=v]+/,""),t);return n?n.version:null},t.SemVer=p,p.prototype.format=function(){return this.version=this.major+"."+this.minor+"."+this.patch,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version},p.prototype.toString=function(){return this.version},p.prototype.compare=function(e){return n("SemVer.compare",this.version,this.options,e),e instanceof p||(e=new p(e,this.options)),this.compareMain(e)||this.comparePre(e)},p.prototype.compareMain=function(e){return e instanceof p||(e=new p(e,this.options)),m(this.major,e.major)||m(this.minor,e.minor)||m(this.patch,e.patch)},p.prototype.comparePre=function(e){if(e instanceof p||(e=new p(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;var t=0;do{var r=this.prerelease[t],o=e.prerelease[t];if(n("prerelease compare",t,r,o),void 0===r&&void 0===o)return 0;if(void 0===o)return 1;if(void 0===r)return-1;if(r!==o)return m(r,o)}while(++t)},p.prototype.compareBuild=function(e){e instanceof p||(e=new p(e,this.options));var t=0;do{var r=this.build[t],o=e.build[t];if(n("prerelease compare",t,r,o),void 0===r&&void 0===o)return 0;if(void 0===o)return 1;if(void 0===r)return-1;if(r!==o)return m(r,o)}while(++t)},p.prototype.inc=function(e,t){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t),this.inc("pre",t);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t),this.inc("pre",t);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":if(0===this.prerelease.length)this.prerelease=[0];else{for(var n=this.prerelease.length;--n>=0;)"number"==typeof this.prerelease[n]&&(this.prerelease[n]++,n=-2);-1===n&&this.prerelease.push(0)}t&&(this.prerelease[0]===t?isNaN(this.prerelease[1])&&(this.prerelease=[t,0]):this.prerelease=[t,0]);break;default:throw new Error("invalid increment argument: "+e)}return this.format(),this.raw=this.version,this},t.inc=function(e,t,n,r){"string"==typeof n&&(r=n,n=void 0);try{return new p(e,n).inc(t,r).version}catch(e){return null}},t.diff=function(e,t){if(E(e,t))return null;var n=u(e),r=u(t),o="";if(n.prerelease.length||r.prerelease.length){o="pre";var a="prerelease"}for(var i in n)if(("major"===i||"minor"===i||"patch"===i)&&n[i]!==r[i])return o+i;return a},t.compareIdentifiers=m;var f=/^[0-9]+$/;function m(e,t){var n=f.test(e),r=f.test(t);return n&&r&&(e=+e,t=+t),e===t?0:n&&!r?-1:r&&!n?1:e<t?-1:1}function d(e,t,n){return new p(e,n).compare(new p(t,n))}function h(e,t,n){return d(e,t,n)>0}function v(e,t,n){return d(e,t,n)<0}function E(e,t,n){return 0===d(e,t,n)}function g(e,t,n){return 0!==d(e,t,n)}function S(e,t,n){return d(e,t,n)>=0}function R(e,t,n){return d(e,t,n)<=0}function y(e,t,n,r){switch(t){case"===":return"object"==typeof e&&(e=e.version),"object"==typeof n&&(n=n.version),e===n;case"!==":return"object"==typeof e&&(e=e.version),"object"==typeof n&&(n=n.version),e!==n;case"":case"=":case"==":return E(e,n,r);case"!=":return g(e,n,r);case">":return h(e,n,r);case">=":return S(e,n,r);case"<":return v(e,n,r);case"<=":return R(e,n,r);default:throw new TypeError("Invalid operator: "+t)}}function b(e,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof b){if(e.loose===!!t.loose)return e;e=e.value}if(!(this instanceof b))return new b(e,t);n("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===I?this.value="":this.value=this.operator+this.semver.version,n("comp",this)}t.rcompareIdentifiers=function(e,t){return m(t,e)},t.major=function(e,t){return new p(e,t).major},t.minor=function(e,t){return new p(e,t).minor},t.patch=function(e,t){return new p(e,t).patch},t.compare=d,t.compareLoose=function(e,t){return d(e,t,!0)},t.compareBuild=function(e,t,n){var r=new p(e,n),o=new p(t,n);return r.compare(o)||r.compareBuild(o)},t.rcompare=function(e,t,n){return d(t,e,n)},t.sort=function(e,n){return e.sort((function(e,r){return t.compareBuild(e,r,n)}))},t.rsort=function(e,n){return e.sort((function(e,r){return t.compareBuild(r,e,n)}))},t.gt=h,t.lt=v,t.eq=E,t.neq=g,t.gte=S,t.lte=R,t.cmp=y,t.Comparator=b;var I={};function O(e,t){if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),e instanceof O)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new O(e.raw,t);if(e instanceof b)return new O(e.value,t);if(!(this instanceof O))return new O(e,t);if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e,this.set=e.split(/\s*\|\|\s*/).map((function(e){return this.parseRange(e.trim())}),this).filter((function(e){return e.length})),!this.set.length)throw new TypeError("Invalid SemVer Range: "+e);this.format()}function q(e,t){for(var n=!0,r=e.slice(),o=r.pop();n&&r.length;)n=r.every((function(e){return o.intersects(e,t)})),o=r.pop();return n}function L(e){return!e||"x"===e.toLowerCase()||"*"===e}function w(e,t,n,r,o,a,i,c,s,l,u,p,f){return((t=L(n)?"":L(r)?">="+n+".0.0":L(o)?">="+n+"."+r+".0":">="+t)+" "+(c=L(s)?"":L(l)?"<"+(+s+1)+".0.0":L(u)?"<"+s+"."+(+l+1)+".0":p?"<="+s+"."+l+"."+u+"-"+p:"<="+c)).trim()}function N(e,t,r){for(var o=0;o<e.length;o++)if(!e[o].test(t))return!1;if(t.prerelease.length&&!r.includePrerelease){for(o=0;o<e.length;o++)if(n(e[o].semver),e[o].semver!==I&&e[o].semver.prerelease.length>0){var a=e[o].semver;if(a.major===t.major&&a.minor===t.minor&&a.patch===t.patch)return!0}return!1}return!0}function C(e,t,n){try{t=new O(t,n)}catch(e){return!1}return t.test(e)}function T(e,t,n,r){var o,a,i,c,s;switch(e=new p(e,r),t=new O(t,r),n){case">":o=h,a=R,i=v,c=">",s=">=";break;case"<":o=v,a=S,i=h,c="<",s="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(C(e,t,r))return!1;for(var l=0;l<t.set.length;++l){var u=t.set[l],f=null,m=null;if(u.forEach((function(e){e.semver===I&&(e=new b(">=0.0.0")),f=f||e,m=m||e,o(e.semver,f.semver,r)?f=e:i(e.semver,m.semver,r)&&(m=e)})),f.operator===c||f.operator===s)return!1;if((!m.operator||m.operator===c)&&a(e,m.semver))return!1;if(m.operator===s&&i(e,m.semver))return!1}return!0}b.prototype.parse=function(e){var t=this.options.loose?o[i.COMPARATORLOOSE]:o[i.COMPARATOR],n=e.match(t);if(!n)throw new TypeError("Invalid comparator: "+e);this.operator=void 0!==n[1]?n[1]:"","="===this.operator&&(this.operator=""),n[2]?this.semver=new p(n[2],this.options.loose):this.semver=I},b.prototype.toString=function(){return this.value},b.prototype.test=function(e){if(n("Comparator.test",e,this.options.loose),this.semver===I||e===I)return!0;if("string"==typeof e)try{e=new p(e,this.options)}catch(e){return!1}return y(e,this.operator,this.semver,this.options)},b.prototype.intersects=function(e,t){if(!(e instanceof b))throw new TypeError("a Comparator is required");var n;if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),""===this.operator)return""===this.value||(n=new O(e.value,t),C(this.value,n,t));if(""===e.operator)return""===e.value||(n=new O(this.value,t),C(e.semver,n,t));var r=!(">="!==this.operator&&">"!==this.operator||">="!==e.operator&&">"!==e.operator),o=!("<="!==this.operator&&"<"!==this.operator||"<="!==e.operator&&"<"!==e.operator),a=this.semver.version===e.semver.version,i=!(">="!==this.operator&&"<="!==this.operator||">="!==e.operator&&"<="!==e.operator),c=y(this.semver,"<",e.semver,t)&&(">="===this.operator||">"===this.operator)&&("<="===e.operator||"<"===e.operator),s=y(this.semver,">",e.semver,t)&&("<="===this.operator||"<"===this.operator)&&(">="===e.operator||">"===e.operator);return r||o||a&&i||c||s},t.Range=O,O.prototype.format=function(){return this.range=this.set.map((function(e){return e.join(" ").trim()})).join("||").trim(),this.range},O.prototype.toString=function(){return this.range},O.prototype.parseRange=function(e){var t=this.options.loose;e=e.trim();var r=t?o[i.HYPHENRANGELOOSE]:o[i.HYPHENRANGE];e=e.replace(r,w),n("hyphen replace",e),e=e.replace(o[i.COMPARATORTRIM],"$1$2$3"),n("comparator trim",e,o[i.COMPARATORTRIM]),e=(e=(e=e.replace(o[i.TILDETRIM],"$1~")).replace(o[i.CARETTRIM],"$1^")).split(/\s+/).join(" ");var a=t?o[i.COMPARATORLOOSE]:o[i.COMPARATOR],c=e.split(" ").map((function(e){return function(e,t){return n("comp",e,t),e=function(e,t){return e.trim().split(/\s+/).map((function(e){return function(e,t){n("caret",e,t);var r=t.loose?o[i.CARETLOOSE]:o[i.CARET];return e.replace(r,(function(t,r,o,a,i){var c;return n("caret",e,t,r,o,a,i),L(r)?c="":L(o)?c=">="+r+".0.0 <"+(+r+1)+".0.0":L(a)?c="0"===r?">="+r+"."+o+".0 <"+r+"."+(+o+1)+".0":">="+r+"."+o+".0 <"+(+r+1)+".0.0":i?(n("replaceCaret pr",i),c="0"===r?"0"===o?">="+r+"."+o+"."+a+"-"+i+" <"+r+"."+o+"."+(+a+1):">="+r+"."+o+"."+a+"-"+i+" <"+r+"."+(+o+1)+".0":">="+r+"."+o+"."+a+"-"+i+" <"+(+r+1)+".0.0"):(n("no pr"),c="0"===r?"0"===o?">="+r+"."+o+"."+a+" <"+r+"."+o+"."+(+a+1):">="+r+"."+o+"."+a+" <"+r+"."+(+o+1)+".0":">="+r+"."+o+"."+a+" <"+(+r+1)+".0.0"),n("caret return",c),c}))}(e,t)})).join(" ")}(e,t),n("caret",e),e=function(e,t){return e.trim().split(/\s+/).map((function(e){return function(e,t){var r=t.loose?o[i.TILDELOOSE]:o[i.TILDE];return e.replace(r,(function(t,r,o,a,i){var c;return n("tilde",e,t,r,o,a,i),L(r)?c="":L(o)?c=">="+r+".0.0 <"+(+r+1)+".0.0":L(a)?c=">="+r+"."+o+".0 <"+r+"."+(+o+1)+".0":i?(n("replaceTilde pr",i),c=">="+r+"."+o+"."+a+"-"+i+" <"+r+"."+(+o+1)+".0"):c=">="+r+"."+o+"."+a+" <"+r+"."+(+o+1)+".0",n("tilde return",c),c}))}(e,t)})).join(" ")}(e,t),n("tildes",e),e=function(e,t){return n("replaceXRanges",e,t),e.split(/\s+/).map((function(e){return function(e,t){e=e.trim();var r=t.loose?o[i.XRANGELOOSE]:o[i.XRANGE];return e.replace(r,(function(r,o,a,i,c,s){n("xRange",e,r,o,a,i,c,s);var l=L(a),u=l||L(i),p=u||L(c),f=p;return"="===o&&f&&(o=""),s=t.includePrerelease?"-0":"",l?r=">"===o||"<"===o?"<0.0.0-0":"*":o&&f?(u&&(i=0),c=0,">"===o?(o=">=",u?(a=+a+1,i=0,c=0):(i=+i+1,c=0)):"<="===o&&(o="<",u?a=+a+1:i=+i+1),r=o+a+"."+i+"."+c+s):u?r=">="+a+".0.0"+s+" <"+(+a+1)+".0.0"+s:p&&(r=">="+a+"."+i+".0"+s+" <"+a+"."+(+i+1)+".0"+s),n("xRange return",r),r}))}(e,t)})).join(" ")}(e,t),n("xrange",e),e=function(e,t){return n("replaceStars",e,t),e.trim().replace(o[i.STAR],"")}(e,t),n("stars",e),e}(e,this.options)}),this).join(" ").split(/\s+/);return this.options.loose&&(c=c.filter((function(e){return!!e.match(a)}))),c=c.map((function(e){return new b(e,this.options)}),this)},O.prototype.intersects=function(e,t){if(!(e instanceof O))throw new TypeError("a Range is required");return this.set.some((function(n){return q(n,t)&&e.set.some((function(e){return q(e,t)&&n.every((function(n){return e.every((function(e){return n.intersects(e,t)}))}))}))}))},t.toComparators=function(e,t){return new O(e,t).set.map((function(e){return e.map((function(e){return e.value})).join(" ").trim().split(" ")}))},O.prototype.test=function(e){if(!e)return!1;if("string"==typeof e)try{e=new p(e,this.options)}catch(e){return!1}for(var t=0;t<this.set.length;t++)if(N(this.set[t],e,this.options))return!0;return!1},t.satisfies=C,t.maxSatisfying=function(e,t,n){var r=null,o=null;try{var a=new O(t,n)}catch(e){return null}return e.forEach((function(e){a.test(e)&&(r&&-1!==o.compare(e)||(o=new p(r=e,n)))})),r},t.minSatisfying=function(e,t,n){var r=null,o=null;try{var a=new O(t,n)}catch(e){return null}return e.forEach((function(e){a.test(e)&&(r&&1!==o.compare(e)||(o=new p(r=e,n)))})),r},t.minVersion=function(e,t){e=new O(e,t);var n=new p("0.0.0");if(e.test(n))return n;if(n=new p("0.0.0-0"),e.test(n))return n;n=null;for(var r=0;r<e.set.length;++r){e.set[r].forEach((function(e){var t=new p(e.semver.version);switch(e.operator){case">":0===t.prerelease.length?t.patch++:t.prerelease.push(0),t.raw=t.format();case"":case">=":n&&!h(n,t)||(n=t);break;case"<":case"<=":break;default:throw new Error("Unexpected operation: "+e.operator)}}))}if(n&&e.test(n))return n;return null},t.validRange=function(e,t){try{return new O(e,t).range||"*"}catch(e){return null}},t.ltr=function(e,t,n){return T(e,t,"<",n)},t.gtr=function(e,t,n){return T(e,t,">",n)},t.outside=T,t.prerelease=function(e,t){var n=u(e,t);return n&&n.prerelease.length?n.prerelease:null},t.intersects=function(e,t,n){return e=new O(e,n),t=new O(t,n),e.intersects(t)},t.coerce=function(e,t){if(e instanceof p)return e;"number"==typeof e&&(e=String(e));if("string"!=typeof e)return null;var n=null;if((t=t||{}).rtl){for(var r;(r=o[i.COERCERTL].exec(e))&&(!n||n.index+n[0].length!==e.length);)n&&r.index+r[0].length===n.index+n[0].length||(n=r),o[i.COERCERTL].lastIndex=r.index+r[1].length+r[2].length;o[i.COERCERTL].lastIndex=-1}else n=e.match(o[i.COERCE]);if(null===n)return null;return u(n[2]+"."+(n[3]||"0")+"."+(n[4]||"0"),t)}})),vn=(hn.SEMVER_SPEC_VERSION,hn.re,hn.src,hn.tokens,hn.parse,hn.valid,hn.clean,hn.SemVer,hn.inc,hn.diff,hn.compareIdentifiers,hn.rcompareIdentifiers,hn.major,hn.minor,hn.patch,hn.compare,hn.compareLoose,hn.compareBuild,hn.rcompare,hn.sort,hn.rsort,hn.gt,hn.lt,hn.eq,hn.neq,hn.gte,hn.lte,hn.cmp,hn.Comparator,hn.Range,hn.toComparators,hn.satisfies),En=(hn.maxSatisfying,hn.minSatisfying,hn.minVersion,hn.validRange,hn.ltr,hn.gtr,hn.outside,hn.prerelease,hn.intersects,hn.coerce,{});function gn(e,t,n,r){return Sn.apply(this,arguments)}function Sn(){return(Sn=se(regeneratorRuntime.mark((function e(t,n,r,o){var a,i,c,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="".concat(t,"__").concat(n),En[a]||(i="".concat(t).concat(n&&" v".concat(n)||""),c=(o||r.config.load)({name:t,version:n},r.public.env),s=Promise.resolve(c),En[a]=s.then((function(e){if(!e)throw new Error("load() of supernova '".concat(i,"' resolved to an invalid object"));return e})).catch((function(e){throw r.logger.warn(e),new Error("Failed to load supernova: '".concat(i,"'"))}))),e.abrupt("return",En[a]);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Rn(e,t){var n={},r=null;return{get:function(e){return n[e]},register:function(o,a){if(n[o])throw new Error("Supernova '".concat(e,"@").concat(o,"' already registered."));n[o]=function(e,t){var n,r,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=o.meta,i={name:e.name,version:e.version,supportsPropertiesVersion:function(e){return!(e&&a&&a.deps&&a.deps.properties)||vn(e,a.deps.properties)},supernova:function(){return gn(i.name,i.version,t,o.load).then((function(e){return n=n||ae(e,t.public.env),r=JSON.stringify(n.qae.properties.initial),n}))},initialProperties:function(e){return this.supernova().then((function(){return fe({qInfo:{qType:i.name},visualization:i.name,version:i.version,showTitles:!0},JSON.parse(r),{},e)}))}};return i}({name:e,version:o},t,a),r=null},getMatchingVersionFromProperties:function(e){var t,o;r||(t=Object.keys(n),o=t.filter((function(e){return"undefined"===e})),r=[].concat(he(o),he(t.filter((function(e){return"undefined"!==e})).map((function(e){return e.split(".").map((function(e){return parseInt(e,10)}))})).sort((function(e,t){return e[0]-t[0]||e[1]-t[1]||e[2]-t[2]})).map((function(e){return e.join(".")})))));for(var a=r.length-1;a>=0;a--){if(n[r[a]].supportsPropertiesVersion(e))return r[a]}return null},versions:n}}function yn(e){var t=e.corona,n=e.parent,r={},o=n||{get:function(){}};return{register:function(e,n){r[e.name]||(r[e.name]=Rn(e.name,t)),r[e.name].register(e.version,n)},getSupportedVersion:function(e,t){return r[e]?r[e].getMatchingVersionFromProperties(t):null},get:function(e){var t=e.name,n=e.version;return r[t]&&r[t].versions[n]||this.register({name:t,version:n}),r[t].get(n)||o.get(e)},clearFromCache:function(e){r[e]&&(r[e]=void 0),function(e){Object.keys(En).forEach((function(t){t.split("__")[0]===e&&(En[t]=void 0)}))}(e)}}}var bn,In={OFF:0,ERROR:1,WARN:2,INFO:3,DEBUG:4},On=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.level,r=void 0===n?In.OFF:n,o=t.pipe,a=void 0===o?console:o,i=r,c=(le(e={},In.OFF,(function(){})),le(e,In.ERROR,(function(){return a.error.apply(a,arguments)})),le(e,In.WARN,(function(){return a.warn.apply(a,arguments)})),le(e,In.INFO,(function(){return a.info.apply(a,arguments)})),le(e,In.DEBUG,(function(){return a.log.apply(a,arguments)})),e),s=function(e){if(e&&!(i<e)){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];(c[e]||c[In.DEBUG]).apply(void 0,n)}};return{log:s,error:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return s.apply(void 0,[In.ERROR].concat(t))},warn:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return s.apply(void 0,[In.WARN].concat(t))},info:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return s.apply(void 0,[In.INFO].concat(t))},debug:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return s.apply(void 0,[In.DEBUG].concat(t))},level:function(e){return"number"==typeof e&&(i=e),i},LOG_LEVEL:In}},qn={context:{theme:"light",language:"en-US",constraints:{}},load:function(){},log:{level:1},types:[],themes:[],env:{},snapshot:{get:(bn=se(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/njs/snapshot/".concat(t));case 2:if((n=e.sent).ok){e.next=5;break}throw new Error(n.statusText);case 5:return e.abrupt("return",n.json());case 6:case"end":return e.stop()}}),e)}))),function(e){return bn.apply(this,arguments)}),capture:function(e){return fetch("/njs/capture",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((function(e){return e.json()}))}}},Ln=function(e,t){return{context:fe({},e.context,{},t.context||{}),load:t.load||e.load,snapshot:fe({},t.snapshot||e.snapshot),types:[].concat(he(e.types||[]),he(t.types||[])),themes:[].concat(he(e.themes||[]),he(t.themes||[])),env:fe({},e.env||{},{},t.env||{}),log:fe({},e.log||{},{},t.log||{})}};var wn=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=On(t.log),r=Ee(t.context.language);function o(e,a){if(a)return o.configured(a)(e);var i=fe({},t.context,{translator:r.translator}),c=de(st({app:e,context:i}),1)[0],s=Se({themes:t.themes,logger:n,root:c}),l={env:{translator:r.translator,nucleus:o},theme:s.externalAPI,translator:r.translator,nebbie:null},u={app:e,root:c,logger:n,config:t,public:l,context:i,nebbie:null},p=yn({corona:u});t.types.forEach((function(e){return p.register({name:e.name,version:e.version},{meta:e.meta,load:e.load})}));var f,m,d,h,v=s.setTheme(t.context.theme),E=null,g=null,S={get:(h=se(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v;case 2:return e.abrupt("return",mn(t,n,u));case 3:case"end":return e.stop()}}),e)}))),function(e,t){return h.apply(this,arguments)}),create:(d=se(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v;case 2:return e.abrupt("return",pn(t,n,u));case 3:case"end":return e.stop()}}),e)}))),function(e,t){return d.apply(this,arguments)}),context:(m=se(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(["theme","language","constraints"].forEach((function(e){t[e]&&t[e]!==i[e]&&(n||(n={}),n[e]=t[e])})),n){e.next=3;break}return e.abrupt("return");case 3:if(i=fe({},i,{},n,{translator:r.translator}),u.context=i,!n.theme){e.next=9;break}return v=s.setTheme(n.theme),e.next=9,v;case 9:n.language&&u.public.translator.language(n.language),c.context(i);case 11:case"end":return e.stop()}}),e)}))),function(e){return m.apply(this,arguments)}),selections:(f=se(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(E){t.next=5;break}return t.next=3,c.getAppSelections();case 3:r=t.sent,E=fe({},r,{mount:function(t){g?n.error("Already mounted"):(g=Ct({element:t,app:e}),c.add(g))},unmount:function(){g&&(c.remove(g),g=null)}});case 5:return t.abrupt("return",E);case 6:case"end":return t.stop()}}),t)}))),function(){return f.apply(this,arguments)}),types:p};return u.public.nebbie=S,S}return o.configured=function(n){return e(Ln(t,n))},o.config=t,o}(qn);export default wn;
