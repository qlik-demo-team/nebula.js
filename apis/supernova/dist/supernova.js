/*
* @nebula.js/supernova v0.1.0-alpha.29
* Copyright (c) 2020 QlikTech International AB
* Released under the MIT license.
*/

!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e=e||self).supernova={})}(this,(function(e){"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(e,t,n,r,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,o)}function r(e){return function(){var t=this,r=arguments;return new Promise((function(o,i){var a=e.apply(t,r);function s(e){n(a,o,i,s,c,"next",e)}function c(e){n(a,o,i,s,c,"throw",e)}s(void 0)}))}}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function c(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}!function(e,t){e(t={exports:{}},t.exports)}((function(e){var n=function(e){var n=Object.prototype,r=n.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function c(e,t,n,r){var o=t&&t.prototype instanceof f?t:f,i=Object.create(o.prototype),a=new k(r||[]);return i._invoke=function(e,t,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return j()}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var s=b(a,n);if(s){if(s===l)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=u(e,t,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===l)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}(e,n,a),i}function u(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var l={};function f(){}function p(){}function h(){}var v={};v[i]=function(){return this};var d=Object.getPrototypeOf,m=d&&d(d(x([])));m&&m!==n&&r.call(m,i)&&(v=m);var y=h.prototype=f.prototype=Object.create(v);function g(e){["next","throw","return"].forEach((function(t){e[t]=function(e){return this._invoke(t,e)}}))}function _(e){var n;this._invoke=function(o,i){function a(){return new Promise((function(n,a){!function n(o,i,a,s){var c=u(e[o],e,i);if("throw"!==c.type){var l=c.arg,f=l.value;return f&&"object"===t(f)&&r.call(f,"__await")?Promise.resolve(f.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):Promise.resolve(f).then((function(e){l.value=e,a(l)}),(function(e){return n("throw",e,a,s)}))}s(c.arg)}(o,i,n,a)}))}return n=n?n.then(a,a):a()}}function b(e,t){var n=e.iterator[t.method];if(void 0===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,b(e,t),"throw"===t.method))return l;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var r=u(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,l;var o=r.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,l):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,l)}function w(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(w,this),this.reset(!0)}function x(e){if(e){var t=e[i];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,o=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return o.next=o}}return{next:j}}function j(){return{value:void 0,done:!0}}return p.prototype=y.constructor=h,h.constructor=p,h[s]=p.displayName="GeneratorFunction",e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,h):(e.__proto__=h,s in e||(e[s]="GeneratorFunction")),e.prototype=Object.create(y),e},e.awrap=function(e){return{__await:e}},g(_.prototype),_.prototype[a]=function(){return this},e.AsyncIterator=_,e.async=function(t,n,r,o){var i=new _(c(t,n,r,o));return e.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},g(y),y[s]="Generator",y[i]=function(){return this},y.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=x,k.prototype={constructor:k,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(O),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var s=r.call(i,"catchLoc"),c=r.call(i,"finallyLoc");if(s&&c){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,l):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),l},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),O(n),l}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;O(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:x(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),l}},e}(e.exports);try{regeneratorRuntime=n}catch(e){Function("r","regeneratorRuntime = r")(n)}}));var u={};function l(){l.init.call(this)}u.isObject=function(e){return"object"==typeof e&&null!==e},u.isNumber=function(e){return"number"==typeof e},u.isUndefined=function(e){return void 0===e},u.isFunction=function(e){return"function"==typeof e};var f=l;l.EventEmitter=l,l.prototype._events=void 0,l.prototype._maxListeners=void 0,l.defaultMaxListeners=10,l.init=function(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0},l.prototype.setMaxListeners=function(e){if(!u.isNumber(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},l.prototype.emit=function(e){var t,n,r,o,i,a;if(this._events||(this._events={}),"error"===e&&!this._events.error)throw(t=arguments[1])instanceof Error?t:Error('Uncaught, unspecified "error" event.');if(n=this._events[e],u.isUndefined(n))return!1;if(u.isFunction(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:for(r=arguments.length,o=new Array(r-1),i=1;i<r;i++)o[i-1]=arguments[i];n.apply(this,o)}else if(u.isObject(n)){for(r=arguments.length,o=new Array(r-1),i=1;i<r;i++)o[i-1]=arguments[i];for(r=(a=n.slice()).length,i=0;i<r;i++)a[i].apply(this,o)}return!0},l.prototype.addListener=function(e,t){var n;if(!u.isFunction(t))throw TypeError("listener must be a function");(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,u.isFunction(t.listener)?t.listener:t),this._events[e]?u.isObject(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,u.isObject(this._events[e])&&!this._events[e].warned)&&((n=u.isUndefined(this._maxListeners)?l.defaultMaxListeners:this._maxListeners)&&n>0&&this._events[e].length>n&&(this._events[e].warned=!0,u.isFunction(console.error)&&console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),u.isFunction(console.trace)&&console.trace()));return this},l.prototype.on=l.prototype.addListener,l.prototype.once=function(e,t){if(!u.isFunction(t))throw TypeError("listener must be a function");var n=!1;function r(){this.removeListener(e,r),n||(n=!0,t.apply(this,arguments))}return r.listener=t,this.on(e,r),this},l.prototype.removeListener=function(e,t){var n,r,o,i;if(!u.isFunction(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(o=(n=this._events[e]).length,r=-1,n===t||u.isFunction(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(u.isObject(n)){for(i=o;i-- >0;)if(n[i]===t||n[i].listener&&n[i].listener===t){r=i;break}if(r<0)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(r,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},l.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[e],u.isFunction(n))this.removeListener(e,n);else if(Array.isArray(n))for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},l.prototype.listeners=function(e){return this._events&&this._events[e]?u.isFunction(this._events[e])?[this._events[e]]:this._events[e].slice():[]},l.listenerCount=function(e,t){return e._events&&e._events[t]?u.isFunction(e._events[t])?1:e._events[t].length:0};var p=Object.prototype.hasOwnProperty,h=Object.prototype.toString,v=Object.defineProperty,d=Object.getOwnPropertyDescriptor,m=function(e){return"function"==typeof Array.isArray?Array.isArray(e):"[object Array]"===h.call(e)},y=function(e){if(!e||"[object Object]"!==h.call(e))return!1;var t,n=p.call(e,"constructor"),r=e.constructor&&e.constructor.prototype&&p.call(e.constructor.prototype,"isPrototypeOf");if(e.constructor&&!n&&!r)return!1;for(t in e);return void 0===t||p.call(e,t)},g=function(e,t){v&&"__proto__"===t.name?v(e,t.name,{enumerable:!0,configurable:!0,value:t.newValue,writable:!0}):e[t.name]=t.newValue},_=function(e,t){if("__proto__"===t){if(!p.call(e,t))return;if(d)return d(e,t).value}return e[t]},b=function e(){var t,n,r,o,i,a,s=arguments[0],c=1,u=arguments.length,l=!1;for("boolean"==typeof s&&(l=s,s=arguments[1]||{},c=2),(null==s||"object"!=typeof s&&"function"!=typeof s)&&(s={});c<u;++c)if(null!=(t=arguments[c]))for(n in t)r=_(s,n),s!==(o=_(t,n))&&(l&&o&&(y(o)||(i=m(o)))?(i?(i=!1,a=r&&m(r)?r:[]):a=r&&y(r)?r:{},g(s,{name:n,newValue:e(l,a,o)})):void 0!==o&&g(s,{name:n,newValue:o}));return s}.bind(null,!0),w={},O=Array.isArray;function k(e){return null!=e&&!Array.isArray(e)&&"object"===t(e)}function x(e){return void 0===e}function j(e,t){return"function"==typeof e[t]||"$$"===t.substring(0,2)||"_"===t.substring(0,1)}function L(e,t){var n,r=t.substring(1).split("/").slice(0,-1);return r.forEach((function(t,o){if(o!==r.length){n=+t;var i=isNaN(n)?{}:[];e[n||t]=x(e[n||t])?i:e[t],e=e[n||t]}})),e}function E(e,t){var n=!0;if(k(e)&&k(t))return Object.keys(e).length===Object.keys(t).length&&(Object.keys(e).forEach((function(r){E(e[r],t[r])||(n=!1)})),n);if(O(e)&&O(t)){if(e.length!==t.length)return!1;for(var r=0,o=e.length;r<o;r+=1)if(!E(e[r],t[r]))return!1;return!0}return e===t}w.generate=function(e,t,n){n=n||"";var r=[];return Object.keys(t).forEach((function(o){var i=function(e){return e?b({},{val:e}).val:e}(t[o]),a=e[o],s="".concat(n,"/").concat(o);E(i,a)||j(t,o)||(x(a)?r.push({op:"add",path:s,value:i}):k(i)&&k(a)?r=r.concat(w.generate(a,i,s)):O(i)&&O(a)?r=r.concat(function(e,t,n){var r=[],o=e.slice(),i=-1;function a(e,t,n){if(e[n]&&x(e[n].qInfo))return null;if(e[n]&&e[n].qInfo.qId===t)return n;for(var r=0,o=e.length;r<o;r+=1)if(e[r]&&e[r].qInfo.qId===t)return r;return-1}if(E(t,o))return r;if(!x(t[0])&&x(t[0].qInfo))return r.push({op:"replace",path:n,value:t}),r;for(var s=o.length-1;s>=0;s-=1)-1===(i=a(t,o[s].qInfo&&o[s].qInfo.qId,s))?(r.push({op:"remove",path:"".concat(n,"/").concat(s)}),o.splice(s,1)):r=r.concat(w.generate(o[s],t[i],"".concat(n,"/").concat(s)));for(var c=0,u=t.length;c<u;c+=1)-1===(i=a(o,t[c].qInfo&&t[c].qInfo.qId))?(r.push({op:"add",path:"".concat(n,"/").concat(c),value:t[c]}),o.splice(c,0,t[c])):i!==c&&(r.push({op:"move",path:"".concat(n,"/").concat(c),from:"".concat(n,"/").concat(i)}),o.splice(c,0,o.splice(i,1)[0]));return r}(a,i,s)):r.push({op:"replace",path:"".concat(n,"/").concat(o),value:i}))})),Object.keys(e).forEach((function(o){x(t[o])&&!j(e,o)&&r.push({op:"remove",path:"".concat(n,"/").concat(o)})})),r},w.apply=function(e,t){t.forEach((function(t){var n,r=L(e,t.path),o=t.path.split("/").splice(-1)[0],i=o&&isNaN(+o)?r[o]:r[+o]||r,a=t.from?t.from.split("/").splice(-1)[0]:null;if("/"===t.path&&(r=null,i=e),"add"===t.op||"replace"===t.op)if(O(r))"-"===o&&(o=r.length),r.splice(+o,"add"===t.op?0:1,t.value);else if(O(i)&&O(t.value)){var s,u=t.value.slice();i.length=0,(s=i).push.apply(s,c(u))}else if(k(i)&&k(t.value))n=i,Object.keys(n).forEach((function(e){Object.getOwnPropertyDescriptor(n,e).configurable&&!j(n,e)&&delete n[e]})),b(i,t.value);else{if(!r)throw new Error("Patchee is not an object we can patch");r[o]=t.value}else if("move"===t.op){var l=L(e,t.from);O(r)?r.splice(+o,0,l.splice(+a,1)[0]):(r[o]=l[a],delete l[a])}else"remove"===t.op&&(O(r)?r.splice(+o,1):delete r[o])}))},w.clone=function(e){return b({},e)},w.createPatch=function(e,t,n){var r={op:e.toLowerCase(),path:n};return"move"===r.op?r.from=t:void 0!==t&&(r.value=t),r},w.updateObject=function(e,t){Object.keys(e).length?w.apply(e,w.generate(e,t)):b(e,t)};var P,A,S=function(e){return function(t){var n,r=(n=a({},t,{action:function(){"function"==typeof t.action&&t.action.call(r,e),r.emit("changed")},enabled:function(){return"function"!=typeof t.enabled||t.enabled.call(r,e)},active:"function"==typeof t.active?function(){return t.active.call(r,e)}:void 0}),Object.keys(f.prototype).forEach((function(e){n[e]=f.prototype[e]})),f.init(n),n);return r}};function I(e,t){if(!e)return!0;if(t.length!==e.length)return!0;for(var n=0;n<t.length;n++)if(e[n]!==t[n])return!0;return!1}function q(e){e.__hooks={obsolete:!1,error:!1,chain:{promise:null,resolve:function(){}},list:[],snaps:[],actions:[],pendingEffects:[],pendingLayoutEffects:[],pendingPromises:[]}}function N(e){C(e.__hooks.list,!0),e.__hooks.obsolete=!0,e.__hooks.list.length=0,e.__hooks.pendingEffects.length=0,e.__hooks.pendingLayoutEffects.length=0,e.__hooks.actions.length=0,e.__hooks.dispatchActions=null,e.__hooks.imperativeHandle=null,clearTimeout(e.__hooks.micro),cancelAnimationFrame(e.__hooks.macro)}function F(e){return T.apply(this,arguments)}function T(){return(T=r(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.__hooks.obsolete){e.next=2;break}return e.abrupt("return",Promise.resolve());case 2:A=-1,-1,(P=t).__hooks.initiated&&P.__hooks.list.length;try{P.fn.call(null)}catch(e){console.error(e)}return P.__hooks.initiated=!0,n=P.__hooks,A=void 0,P=void 0,n.chain.promise||(n.chain.promise=new Promise((function(e){n.chain.resolve=e}))),H(n),M(n),e.abrupt("return",n.chain.promise);case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function C(e,t){try{e.forEach((function(e){"function"==typeof e.teardown&&e.teardown(),t||(e.teardown=e.value[0]())}))}catch(e){console.error(e)}e.length=0}function H(e){C(e.pendingLayoutEffects)}function D(e,t){try{return Promise.all(e.__hooks.snaps.map((function(e){return Promise.resolve(e.fn(t))}))).then((function(e){return e[e.length-1]}))}catch(e){console.error(e)}return Promise.resolve()}function G(e){return e.__hooks.imperativeHandle}function R(e){e._dispatchActions&&e._dispatchActions(e.__hooks.actions.slice())}function z(e,t){e._dispatchActions=t,e.__hooks&&R(e)}function $(e){if(void 0===P)throw new Error("Invalid nebula hook call. Hooks can only be called inside a supernova component.");var t=P.__hooks;return e>=t.list.length&&t.list.push({}),t.list[e]}function M(e){e.macro||(e.macro=requestAnimationFrame((function(){!function(e){C(e.pendingEffects),e.macro=null,function(e){if(e.pendingPromises.length||e.micro||e.macro)return;e.chain.promise=null,e.chain.resolve()}(e)}(e)})))}function U(e){return $(++A),P.context[e]}function V(e){return{__hooked:!0,fn:e,initiate:q,run:F,teardown:N,runSnaps:D,observeActions:z,getImperativeHandle:G}}function J(e){var t=$(++A);if(!t.value){t.component=P;t.value=["function"==typeof e?e():e,function(e){if(!t.component.__hooks.obsolete){var n,r="function"==typeof e?e(t.value[0]):e;r!==t.value[0]&&(t.value[0]=r,(n=t.component).__hooks.micro||(n.__hooks.micro=setTimeout((function(){n.__hooks.micro=null,F(n)}),0)))}}]}return t.value}function B(e,t){var n=$(++A);I(n.value?n.value[1]:void 0,t)&&(n.value=[e,t],P.__hooks.pendingLayoutEffects.push(n))}function Y(e,t){var n=$(++A);return I(n.value?n.value[0]:void 0,t)&&(n.value=[t,e()]),n.value[1]}function K(){return U("element")}var Q={app:null,model:null,actions:null,selections:null,created:function(){},mounted:function(){},render:function(){},resize:function(){},willUnmount:function(){},destroy:function(){},emit:function(){},getViewState:function(){},observeActions:function(){},setSnapshotData:function(e){return Promise.resolve(e)}},W=Object.keys(Q);function X(e,t){var n,r=a({},Q);n=r,Object.keys(f.prototype).forEach((function(e){n[e]=f.prototype[e]})),f.init(n);var o={emit:function(){r.emit.apply(r,arguments)}};Object.keys(e.component||{}).forEach((function(t){-1!==W.indexOf(t)?r[t]=e.component[t].bind(o):o[t]=e.component[t]}));var i,s,c,u,l,p,h=(s=(i={sn:e,component:o}).sn,c=i.component,u={},l=[],p=S(c),((s.definition.selectionToolbar||{}).items||[]).forEach((function(e){var t=p(e);u[e.key]=t,l.push(t)})),(s.definition.actions||[]).forEach((function(e){var t=p(e);u[e.key]=t})),{actions:u,selectionToolbarItems:l,destroy:function(){l.length=0}}),v=t.app&&t.app.session?t.app.session.getObjectApi({handle:-1}):null;return Object.assign(o,{model:t.model,app:t.app,global:v,selections:t.selections,actions:h.actions}),Object.assign(r,{actions:h.actions,model:t.model,app:t.app,selections:t.selections}),[r,h]}function Z(e,t,n){"function"==typeof e.component&&(e.component=V(e.component));var r=s(e.component&&e.component.__hooked?function(e,t,n){var r=t.app&&t.app.session?t.app.session.getObjectApi({handle:-1}):void 0,o=!1,i={},s=["appLayout","constraints","options"],c={};t.model&&t.model.session||(c.select=!0);var u={context:{model:t.model,app:t.app,global:r,selections:t.selections,element:void 0,theme:void 0,translator:n.translator,layout:{},appLayout:{},constraints:c,options:{}},env:n,fn:e.component.fn,created:function(){},mounted:function(t){this.context.element=t,e.component.initiate(u)},render:function(t){var n=this,r=!o||!1;return t?(t.layout&&(r=!0,this.context.layout=t.layout),t.context&&t.context.theme&&(this.context.theme=t.context.theme),s.forEach((function(e){var o="options"===e?t:t.context;if(o&&Object.prototype.hasOwnProperty.call(o,e)){var s=JSON.stringify(o[e]);"constraints"===e&&(s=JSON.stringify(a({},o[e],{},c))),s!==i[e]&&(r=!0,i[e]=s,n.context[e]=JSON.parse(s))}}))):r=!0,this.context.theme&&this.context.theme.name()!==i.themeName&&(r=!0,i.themeName=this.context.theme.name()),this.context.translator.language()!==i.language&&(r=!0,i.language=u.context.translator.language()),r?(o=!0,e.component.run(this)):Promise.resolve()},resize:function(){return this.render()},willUnmount:function(){e.component.teardown(this)},setSnapshotData:function(t){return e.component.runSnaps(this,t)},getImperativeHandle:function(){return e.component.getImperativeHandle(this)},destroy:function(){},observeActions:function(t){e.component.observeActions(this,t)},isHooked:!0};return s.forEach((function(e){i[e]=JSON.stringify("options"===e?u.options:u.context[e])})),i.themeName=u.context.theme?u.context.theme.name():void 0,i.language=u.context.translator?u.context.translator.language():void 0,Object.assign(u,{selections:t.selections}),[u,null]}(e,t,n):X(e,t),2),o=r[0],i=r[1],c=[];return e.qae.properties.onChange&&(t.model.__snInterceptor&&t.model.__snInterceptor.teardown(),t.model.__snInterceptor={setProperties:t.model.setProperties,applyPatches:t.model.applyPatches,teardown:void 0},t.model.setProperties=function(){for(var n,r,o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return(n=e.qae.properties.onChange).call.apply(n,[{model:t.model}].concat(i)),(r=t.model.__snInterceptor.setProperties).call.apply(r,[this].concat(i))},t.model.applyPatches=function(n,r){var o=this,i=r?"getEffectiveProperties":"getProperties";return t.model[i]().then((function(i){var a=w.clone(i),s=n.map((function(e){return{op:e.qOp,value:JSON.parse(e.qValue),path:e.qPath}}));w.apply(i,s),e.qae.properties.onChange.call({model:t.model},i);var c=w.generate(a,i).map((function(e){return{qOp:e.op,qValue:JSON.stringify(e.value),qPath:e.path}}));return t.model.__snInterceptor.applyPatches.call(o,c,r)}))},t.model.__snInterceptor.teardown=function(){t.model.setProperties=t.model.__snInterceptor.setProperties,delete t.model.__snInterceptor},c.push(t.model.__snInterceptor.teardown)),{generator:e,component:o,selectionToolbar:{items:i?i.selectionToolbarItems:[]},destroy:function(){c.forEach((function(e){return e()}))},logicalSize:e.definition.logicalSize||function(){return!1}}}var ee={get:function(e){return"$$$".concat(e,"$$$")}},te=function(){};function ne(e,t){return void 0===e?function(){return t}:function(){return e}}function re(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{min:"function"==typeof e.min?e.min:ne(e.min,0),max:"function"==typeof e.max?e.max:ne(e.max,1e3),added:e.added||e.add||te,description:e.description||te,moved:e.moved||e.move||te,removed:e.removed||e.remove||te,replaced:e.replaced||e.replace||te}}function oe(e){var t=e.path||"/qHyperCubeDef",n=t.slice(0,-3);return{propertyPath:t,layoutPath:n,resolveLayout:function(e){return function(e,t,n){var r=t.split("/"),o=e;if(void 0===o)return n;for(var i=0;i<r.length;++i)if(""!==r[i]){if(void 0===o[r[i]])return n;o=o[r[i]]}return o}(e,n,{})},dimensions:re(e.dimensions),measures:re(e.measures)}}function ie(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.properties||{};t.properties&&(t.properties.initial||t.properties.onChange)&&(n=t.properties.initial,e=t.properties.onChange);var r={properties:{initial:n,onChange:e},data:{targets:((t.data||{}).targets||[]).map(oe)}};return r}e.generator=function(e,t){var n,r=a({translator:ee},t),o={qae:ie((n="function"==typeof e?e(r):e).qae),component:n.component||{},create:function(e){return Z(o,e,r)},definition:{}};return Object.keys(n).forEach((function(e){o[e]||(o.definition[e]=n[e])})),o},e.hook=V,e.onTakeSnapshot=function(e){var t=$(++A);t.value||(t.value=1,P.__hooks.snaps.push(t)),t.fn=e},e.useAction=function(e,t){var n=s(J({action:function(){n._config.action.call(null)}}),1)[0];return n.component||(n.component=P,P.__hooks.actions.push(n)),Y((function(){var t=e();n._config=t,n.active=t.active||!1,n.disabled=t.disabled||!1,n.label=t.label||"",n.getSvgIconShape=t.icon?function(){return t.icon}:void 0,n.key=t.key||n.component.__hooks.actions.length,R(n.component)}),t),[n.action]},e.useApp=function(){var e=U("app");return e&&e.session?e:void 0},e.useAppLayout=function(){return U("appLayout")},e.useConstraints=function(){return U("constraints")},e.useEffect=function(e,t){var n=$(++A);I(n.value?n.value[1]:void 0,t)&&(n.value=[e,t],-1===P.__hooks.pendingEffects.indexOf(n)&&P.__hooks.pendingEffects.push(n))},e.useElement=K,e.useGlobal=function(){var e=U("global");return e&&e.session?e:void 0},e.useImperativeHandle=function(e,t){var n=$(++A);if(n.component||(n.component=P),I(n.value?n.value[0]:void 0,t)){var r=e();n.value=[t,r],n.component.__hooks.imperativeHandle=r}},e.useLayout=function(){return U("layout")},e.useMemo=Y,e.useModel=function(){var e=U("model");return e&&e.session?e:void 0},e.useOptions=function(){return U("options")},e.usePromise=function(e,t){var n=s(J((function(){return{resolved:void 0,rejected:void 0,state:"pending"}})),2),r=n[0],o=n[1],i=$(++A);return i.component||(i.component=P),B((function(){var t=!1;return i.teardown=function(){t=!0,i.teardown=null;var e=i.component.__hooks.pendingPromises.indexOf(i);e>-1&&i.component.__hooks.pendingPromises.splice(e,1)},e().then((function(e){t||(i.teardown&&i.teardown(),o({resolved:e,rejected:void 0,state:"resolved"}))})).catch((function(e){t||(i.teardown&&i.teardown(),o({resolved:void 0,rejected:e,state:"resolved"}))})),i.component.__hooks.pendingPromises.push(i),function(){i.teardown&&i.teardown()}}),t),[r.resolved,r.rejected]},e.useRect=function(){var e=K(),t=s(J((function(){var t=e.getBoundingClientRect();return{left:t.left,top:t.top,width:t.width,height:t.height}})),2),n=t[0],r=t[1],o=J((function(){return{current:{}}}));return o.current=n,B((function(){var t=function(){var t=e.getBoundingClientRect(),n=t.left,i=t.top,a=t.width,s=t.height,c=o.current;c.width===a&&c.height===s&&c.left===n&&c.top===i||r({left:n,top:i,width:a,height:s})};if("function"==typeof ResizeObserver){var n=new ResizeObserver(t);return n.observe(e),function(){n.unobserve(e),n.disconnect(e),n=null}}return window.addEventListener("resize",t),function(){window.removeEventListener("resize",t)}}),[e]),[n]},e.useSelections=function(){return U("selections")},e.useStaleLayout=function(){var e=U("layout"),t=s(J({current:e}),1)[0];return e.qSelectionInfo&&e.qSelectionInfo.qInSelections||(t.current=e),t.current},e.useState=J,e.useTheme=function(){return U("theme")},e.useTranslator=function(){return U("translator")},Object.defineProperty(e,"__esModule",{value:!0})}));
